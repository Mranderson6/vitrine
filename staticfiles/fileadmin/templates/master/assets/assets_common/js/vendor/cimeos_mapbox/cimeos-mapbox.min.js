!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).CimeosMapbox=t()}}(function(){return function(){return function t(e,n,r){function i(s,a){if(!n[s]){if(!e[s]){var l="function"==typeof require&&require;if(!a&&l)return l(s,!0);if(o)return o(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var h=n[s]={exports:{}};e[s][0].call(h.exports,function(t){return i(e[s][1][t]||t)},h,h.exports,t,e,n,r)}return n[s].exports}for(var o="function"==typeof require&&require,s=0;s<r.length;s++)i(r[s]);return i}}()({1:[function(t,e,n){"use strict";const r=t("xtend"),i=t("@turf/bbox").default,o=t("@turf/bbox-polygon").default,s=t("@turf/union").default,a=t("@turf/center-of-mass").default,l=(t("@turf/centroid").default,t("mapbox-gl-generic-geocoder")),u=t("./geocodeBanRequest");function h(t){let e=this;if(this.el=$("#"+t.el),this.markers=[],this.layersIds=[],this.refresh=[],this.lastZoom=null,this.popup=null,this.clusterFeatures={type:"FeatureCollection",features:[]},this.highlightFeatures={type:"FeatureCollection",features:[]},this.geocoderFeatures={type:"FeatureCollection",features:[]},this.geometryFeatures={type:"FeatureCollection",features:[]},0===this.el.length)throw"Unable to find element by id "+t.el;let n=t.rootPath?t.rootPath:"./",i=t.configFile?t.configFile:this.options.configFile;return $.get(n+"configuration/"+i+".json",function(n){e.options=r({},e.options,n,t),e._init()}),this}h.prototype={options:{el:"map",latitude:0,longitude:0,zoom:16,maxZoom:18,rootPath:"./",configFile:"default",scrollZoom:!0,controls:{navigation:{enable:!0},geolocate:{enable:!0},geocoder:{enable:!0,placeholder:"Rechercher une adresse"}}},_init:function(){let t=this;return this.map=new mapboxgl.Map({container:this.options.el,center:[this.options.longitude,this.options.latitude],zoom:this.options.zoom,maxZoom:this.options.maxZoom,maxBounds:this.options.bounds}),this.lastZoom=this.options.zoom,void 0!==this.options.maxBounds&&this.map.setMaxBounds(this.options.maxBounds),void 0!==this.options.source&&this.map.setStyle(this.options.rootPath+"styles/"+this.options.source+".json"),!1===this.options.scrollZoom&&this.map.scrollZoom.disable(),this.map.on("load",function(){$(t).trigger("load"),t._setDefaultData(),t._loadIcons(),t._addEventsListener()}),this._addControls(),this},addMarker:function(t){if(void 0===t.longitude||void 0===t.latitude)throw"No longitude/latitude provided";let e=this._fixMarkerPosition([parseFloat(t.longitude),parseFloat(t.latitude)]);return this.markers.push(e),t.longitude=e[0],t.latitude=e[1],this._addMarkerToSourceWithFeatureCollection(t,"points",this.clusterFeatures)},addGeometry:function(t){if(void 0===t.geometry)throw"No geometry provided";if(void 0===t.geometry.coordinates)throw"No geometry coordinates provided";if(void 0===t.geometry.type)throw"No geometry type provided";let e={type:"Feature",geometry:t.geometry};return void 0!==t.properties&&(e.properties=t.properties),this.geometryFeatures.features.push(e),this._updateSourceWithFeatureCollection("geometry",this.geometryFeatures),e},fitBounds:function(){let t=[1/0,1/0,-1/0,-1/0],e=i(this.clusterFeatures),n=i(this.geometryFeatures);if(this.clusterFeatures.features.length>0&&this.geometryFeatures.features.length>0){let r=o(e),a=o(n),l=s(r,a);t=i(l)}else this.clusterFeatures.features.length>0&&(t=(this.clusterFeatures.features.length,e)),this.geometryFeatures.features.length>0&&(t=n);this.map.setPadding({top:60,bottom:60,left:30,right:30}),this.map.fitBounds(t)},displayPopup:function(t){let e=this,n=t.eventArgs.fields,r=t.eventArgs.additionalCssClasses;if(e.popup=new mapboxgl.Popup({anchor:"top",className:r}),void 0!==t.eventArgs.ajax)$.ajax({url:t.eventArgs.ajax.url,method:"POST",data:t.eventArgs.ajax.data}).done(function(r){if(r.length>=1){let i,o="",s="";if(void 0!==t.eventArgs.ajax.useLocalTemplate&&1===t.eventArgs.ajax.useLocalTemplate){let a=$("#"+t.eventArgs.templateId).get(0).innerHTML;i=r[0][t.eventArgs.ajax.valuesField],s=(o=e._parseTemplateWithFieldsAndValues(a,n,i)).get(0).outerHTML}else s=r;e.popup.setHTML(s)}});else{let r=t.values,i=this._parseTemplateWithFieldsAndValues(template,n,r);e.popup.setHTML(i.get(0).outerHTML)}e.popup.setLngLat(t.coordinates).addTo(e.map),e.popup.on("close",function(t){e.map.isMoving()||e.map.easeTo({center:e.map.getCenter(),zoom:e.lastZoom,padding:{top:0,bottom:0,left:0,right:0}})})},displayModal:function(t){let e=this,n=$("#"+t.eventArgs.contentId),r=$("#"+t.eventArgs.templateId).get(0).innerHTML,i=t.eventArgs.fields;if(void 0!==t.eventArgs.ajax)$.ajax({url:t.eventArgs.ajax.url,method:"POST",data:t.eventArgs.ajax.data}).done(function(o){if(o.length>=1){let s,a="";void 0!==t.eventArgs.ajax.useLocalTemplate&&1===t.eventArgs.ajax.useLocalTemplate?(s=o[0][t.eventArgs.ajax.valuesField],a=e._parseTemplateWithFieldsAndValues(r,i,s)):a=o,n.html(a)}});else{let e=t.values,o=this._parseTemplateWithFieldsAndValues(r,i,e);n.html(o)}n.hasClass("is-hidden")&&(n.foundation("toggle"),n.css("opacity",1)),$(document).trigger("scroll")},displayListPopin:function(t){if("undefined"==typeof list||null===list)throw"list is not defined";if("function"!=typeof list.displayPopin)throw"displayPopin is not a function for argument list";list.displayPopin(t.eventArgs.contentElementId,t.eventArgs.uid,t.eventArgs.title,t.eventArgs.url,t.eventArgs.popinId)},displayMapPopin:function(t){let e=t.values.document;$("body").prepend('<div id="loaderMap" class="reveal-overlay load-popin"><div class="sk-circle"><div class="sk-circle1 sk-child"></div><div class="sk-circle2 sk-child"></div><div class="sk-circle3 sk-child"></div><div class="sk-circle4 sk-child"></div><div class="sk-circle5 sk-child"></div><div class="sk-circle6 sk-child"></div><div class="sk-circle7 sk-child"></div><div class="sk-circle8 sk-child"></div><div class="sk-circle9 sk-child"></div><div class="sk-circle10 sk-child"></div><div class="sk-circle11 sk-child"></div><div class="sk-circle12 sk-child"></div></div></div>');let n=$("#"+t.popinId),r=$("#"+t.listConfigId).attr("data-url-show");n.attr("data-title",e.title),n.attr("data-url",e.url),n.attr("aria-label",n.attr("data-label")+" "+e.title),n.removeAttr("data-label");let i=n.find(".wrap_popin"),o=[];o.push({name:"tx_cimsearchelastic_displaysearch[contentElementId]",value:e.contentElementId}),o.push({name:"tx_cimsearchelastic_displaysearch[itemUid]",value:e.uid}),$.ajax({url:r,type:"POST",dataType:"html",data:o}).done(function(t){$("#loaderMap").remove(),i.html(t),n.foundation(),n.foundation("open"),$(document).trigger("popin")})},clearAll:function(){this.markers=[],this._clearSourceAndFeatureCollection("points",this.clusterFeatures),this._clearSourceAndFeatureCollection("highlight-point",this.highlightFeatures),this._clearSourceAndFeatureCollection("geocoder",this.geocoderFeatures),this._clearSourceAndFeatureCollection("geometry",this.geometryFeatures)},_parseTemplateWithFieldsAndValues:function(t,e,n){for(let e in n){let r=new RegExp("\\[\\["+e+"\\]\\]","g");t=t.replace(r,n[e])}let r=$(t);for(let t in e){let i="popup-"+e[t];void 0===typeof n[e[t]]||void 0===n[e[t]]||""===n[e[t]]?r.find("#"+i).remove():r.find("#"+i).removeAttr(i)}return r},_addMarkerToSourceWithFeatureCollection:function(t,e,n){let r={type:"Feature",geometry:{type:"Point",coordinates:[parseFloat(t.longitude),parseFloat(t.latitude)]}};return void 0!==t.properties&&(r.properties=t.properties),n.features.push(r),this._updateSourceWithFeatureCollection(e,n),r},_clearSourceAndFeatureCollection:function(t,e){e.features=[],this._updateSourceWithFeatureCollection(t,e)},_updateSourceWithFeatureCollection:function(t,e){let n=this;void 0===n.refresh[t]&&(n.refresh[t]=setTimeout(function(){const r=setInterval(function(){void 0!==n.map&&n.map.loaded()&&"undefined"!==n.map.getSource(t)&&(n.map.getSource(t).setData(e),n.refreshIsActive=!1,clearInterval(r))},25);delete n.refresh[t]},15))},_setDefaultData:function(){this.map.getSource("points").setData(this.clusterFeatures),this.map.getSource("highlight-point").setData(this.highlightFeatures),this.map.getSource("geocoder").setData(this.geocoderFeatures),this.map.getSource("geometry").setData(this.geometryFeatures)},_addControls:function(){let t=this;if(this.options.controls.navigation.enable&&this.map.addControl(new mapboxgl.NavigationControl,"bottom-right"),this.options.controls.geolocate.enable&&this.map.addControl(new mapboxgl.GeolocateControl({positionOptions:{enableHighAccuracy:!0},trackUserLocation:!0}),"bottom-right"),this.options.controls.geocoder.enable){let e=new l(this.options.controls.geocoder,u);this.map.addControl(e,"bottom-right"),e.on("result",function(e){t._clearSourceAndFeatureCollection("geocoder",t.geocoderFeatures),t._addMarkerToSourceWithFeatureCollection({latitude:e.result.lat,longitude:e.result.lon},"geocoder",t.geocoderFeatures)})}},_addEventsListener:function(){let t=this;var e=new mapboxgl.Popup({closeButton:!1,closeOnClick:!1,anchor:"top"}),n=new mapboxgl.Popup({closeButton:!1,closeOnClick:!1,anchor:"left"}),r=!1,i=null;t.map.on("mouseenter","unclustered-point-default",function(n){t.map.getCanvas().style.cursor="pointer";let i=n.features[0].geometry.coordinates.slice(),o=n.features[0].properties;if((o.shouldDisplayPopupOnHover||!1)&&!r){let n='<div class="contenu_bloc"><div class="content"><p class="subtitle">'+o.title+"</p></div></div>";e.setLngLat(i).setHTML(n).addTo(t.map),r=!0}}),t.map.on("mouseleave","unclustered-point-default",function(){t.map.getCanvas().style.cursor="",e.remove(),r=!1}),t.map.on("mouseenter","feature-point",function(){t.map.getCanvas().style.cursor="pointer"}),t.map.on("mouseleave","feature-point",function(){t.map.getCanvas().style.cursor=""}),t.map.on("mouseenter","feature-geometry-polygon",function(e){t.map.getCanvas().style.cursor="pointer"}),t.map.on("mousemove","feature-geometry-polygon",function(e){let r=e.lngLat,o=e.features[0].properties;if((o.shouldDisplayPopupOnHover||!1)&&i!==r){n.remove();let e='<div class="contenu_bloc"><div class="content"><p class="subtitle">'+o.title+"</p></div></div>";n.setLngLat(r).trackPointer().setHTML(e).addTo(t.map),i=r}}),t.map.on("mouseleave","feature-geometry-polygon",function(){t.map.getCanvas().style.cursor="",n.remove()}),t.map.on("mouseenter","feature-geometry-line",function(){t.map.getCanvas().style.cursor="pointer"}),t.map.on("mouseleave","feature-geometry-line",function(){t.map.getCanvas().style.cursor=""}),t.map.on("mouseenter","clusters",function(){t.map.getCanvas().style.cursor="pointer"}),t.map.on("mouseleave","clusters",function(){t.map.getCanvas().style.cursor=""}),t.map.on("click",function(e){let n=t.map.queryRenderedFeatures(e.point,{layers:["clusters"]}),r=t.map.queryRenderedFeatures(e.point,{layers:["unclustered-point-default","feature-point","feature-geometry-polygon","feature-geometry-line"]});if(n.length>0&&void 0!==n[0].properties){let e=n[0].properties.cluster_id;t.map.getSource("points").getClusterExpansionZoom(e,function(e,r){e||t.map.easeTo({center:n[0].geometry.coordinates,zoom:r,padding:{top:0,bottom:0,left:0,right:0}})})}else if(r.length>0){let n;n="LineString"===r[0].geometry.type?e.lngLat:"Point"===r[0].geometry.type?r[0].geometry.coordinates.slice():a(r[0]).geometry.coordinates.slice();let o=r[0].properties||null;if(void 0!==o.onClick){t.lastZoom=t.map.getZoom();var i={top:10,bottom:600};let e=t.lastZoom>15?t.lastZoom:15;$("#page").hasClass("list")&&(i={top:10,bottom:10}),t.map.easeTo({center:n,zoom:e,padding:i});let s=JSON.parse(o.onClick);"function"==typeof t[s.callback]&&t[s.callback].apply(t,[{feature:r[0],values:o,eventArgs:s.args,coordinates:n}])}}})},_loadIcons:function(){let t=this;$.each(this.options.icons,function(e,n){t.map.loadImage(t.options.rootPath+n.path,function(e,r){if(e)throw e;t.map.addImage(n.id,r,{sdf:!1})}),t.layersIds.push("unclustered-point-"+n.id),"default"!==n.id&&t.map.addLayer({id:"unclustered-point-"+n.id,type:"symbol",source:"points",filter:["all",["!has","point_count"],["==","icon",n.id]],layout:{"icon-image":n.id,"icon-anchor":"bottom","icon-allow-overlap":!0}})})},_fixMarkerPosition:function(t){if(this.markers.length>0)for(let e=0;e<=this.markers.length;e++)if(void 0!==this.markers[e]){let n=this.markers[e][0],r=this.markers[e][1];if(t[1]===r&&t[0]===n){let e=t[0]+(.8*Math.random()+.2-.5)/800,n=t[1]+(.8*Math.random()+.2-.5)/800;return[parseFloat(e),parseFloat(n)]}}return t}},e.exports=h},{"./geocodeBanRequest":2,"@turf/bbox":4,"@turf/bbox-polygon":3,"@turf/center-of-mass":5,"@turf/centroid":6,"@turf/union":11,"mapbox-gl-generic-geocoder":16,xtend:28}],2:[function(t,e,n){"use strict";e.exports=function(t,e,n){var r={q:t,limit:n.limit,postcode:n.postcode,citycode:n.citycode},i=new URLSearchParams(Object.entries(r));return fetch("https://api-adresse.data.gouv.fr/search/?"+i).then(function(t){return t.ok?t.json():[]}).then(function(t){return t.features.map(function(t){return{name:t.properties.label,lat:t.geometry.coordinates[1],lon:t.geometry.coordinates[0]}})})}},{}],3:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=t("@turf/helpers");n.default=function(t,e){void 0===e&&(e={});var n=Number(t[0]),i=Number(t[1]),o=Number(t[2]),s=Number(t[3]);if(6===t.length)throw new Error("@turf/bbox-polygon does not support BBox with 6 positions");var a=[n,i],l=[n,s],u=[o,s],h=[o,i];return r.polygon([[a,h,u,l,a]],e.properties,{bbox:t,id:e.id})}},{"@turf/helpers":8}],4:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=t("@turf/meta");function i(t){var e=[1/0,1/0,-1/0,-1/0];return r.coordEach(t,function(t){e[0]>t[0]&&(e[0]=t[0]),e[1]>t[1]&&(e[1]=t[1]),e[2]<t[0]&&(e[2]=t[0]),e[3]<t[1]&&(e[3]=t[1])}),e}i.default=i,n.default=i},{"@turf/meta":10}],5:[function(t,e,n){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0});var i=r(t("@turf/convex")),o=r(t("@turf/centroid")),s=t("@turf/helpers"),a=t("@turf/invariant"),l=t("@turf/meta");n.default=function t(e,n){switch(void 0===n&&(n={}),a.getType(e)){case"Point":return s.point(a.getCoord(e),n.properties);case"Polygon":var r=[];l.coordEach(e,function(t){r.push(t)});var u,h,c,f,p,d,g,v,m=o.default(e,{properties:n.properties}),y=m.geometry.coordinates,x=0,b=0,_=0,w=r.map(function(t){return[t[0]-y[0],t[1]-y[1]]});for(u=0;u<r.length-1;u++)f=(h=w[u])[0],d=h[1],p=(c=w[u+1])[0],_+=v=f*(g=c[1])-p*d,x+=(f+p)*v,b+=(d+g)*v;if(0===_)return m;var E=1/(.5*_*6);return s.point([y[0]+E*x,y[1]+E*b],n.properties);default:var k=i.default(e);return k?t(k,{properties:n.properties}):o.default(e,{properties:n.properties})}}},{"@turf/centroid":6,"@turf/convex":7,"@turf/helpers":8,"@turf/invariant":9,"@turf/meta":10}],6:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=t("@turf/meta"),i=t("@turf/helpers");n.default=function(t,e){void 0===e&&(e={});var n=0,o=0,s=0;return r.coordEach(t,function(t){n+=t[0],o+=t[1],s++},!0),i.point([n/s,o/s],e.properties)}},{"@turf/helpers":8,"@turf/meta":10}],7:[function(t,e,n){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0});var i=t("@turf/helpers"),o=t("@turf/meta"),s=r(t("concaveman"));n.default=function(t,e){void 0===e&&(e={}),e.concavity=e.concavity||1/0;var n=[];if(o.coordEach(t,function(t){n.push([t[0],t[1]])}),!n.length)return null;var r=s.default(n,e.concavity);return r.length>3?i.polygon([r]):null}},{"@turf/helpers":8,"@turf/meta":10,concaveman:12}],8:[function(t,e,n){"use strict";function r(t,e,n){void 0===n&&(n={});var r={type:"Feature"};return(0===n.id||n.id)&&(r.id=n.id),n.bbox&&(r.bbox=n.bbox),r.properties=e||{},r.geometry=t,r}function i(t,e,n){if(void 0===n&&(n={}),!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!d(t[0])||!d(t[1]))throw new Error("coordinates must contain numbers");return r({type:"Point",coordinates:t},e,n)}function o(t,e,n){void 0===n&&(n={});for(var i=0,o=t;i<o.length;i++){var s=o[i];if(s.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var a=0;a<s[s.length-1].length;a++)if(s[s.length-1][a]!==s[0][a])throw new Error("First and last Position are not equivalent.")}return r({type:"Polygon",coordinates:t},e,n)}function s(t,e,n){if(void 0===n&&(n={}),t.length<2)throw new Error("coordinates must be an array of two or more positions");return r({type:"LineString",coordinates:t},e,n)}function a(t,e){void 0===e&&(e={});var n={type:"FeatureCollection"};return e.id&&(n.id=e.id),e.bbox&&(n.bbox=e.bbox),n.features=t,n}function l(t,e,n){return void 0===n&&(n={}),r({type:"MultiLineString",coordinates:t},e,n)}function u(t,e,n){return void 0===n&&(n={}),r({type:"MultiPoint",coordinates:t},e,n)}function h(t,e,n){return void 0===n&&(n={}),r({type:"MultiPolygon",coordinates:t},e,n)}function c(t,e){void 0===e&&(e="kilometers");var r=n.factors[e];if(!r)throw new Error(e+" units is invalid");return t*r}function f(t,e){void 0===e&&(e="kilometers");var r=n.factors[e];if(!r)throw new Error(e+" units is invalid");return t/r}function p(t){return 180*(t%(2*Math.PI))/Math.PI}function d(t){return!isNaN(t)&&null!==t&&!Array.isArray(t)}Object.defineProperty(n,"__esModule",{value:!0}),n.earthRadius=6371008.8,n.factors={centimeters:100*n.earthRadius,centimetres:100*n.earthRadius,degrees:n.earthRadius/111325,feet:3.28084*n.earthRadius,inches:39.37*n.earthRadius,kilometers:n.earthRadius/1e3,kilometres:n.earthRadius/1e3,meters:n.earthRadius,metres:n.earthRadius,miles:n.earthRadius/1609.344,millimeters:1e3*n.earthRadius,millimetres:1e3*n.earthRadius,nauticalmiles:n.earthRadius/1852,radians:1,yards:n.earthRadius/1.0936},n.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:.001,kilometres:.001,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/n.earthRadius,yards:1/1.0936},n.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:3.86e-7,millimeters:1e6,millimetres:1e6,yards:1.195990046},n.feature=r,n.geometry=function(t,e,n){switch(void 0===n&&(n={}),t){case"Point":return i(e).geometry;case"LineString":return s(e).geometry;case"Polygon":return o(e).geometry;case"MultiPoint":return u(e).geometry;case"MultiLineString":return l(e).geometry;case"MultiPolygon":return h(e).geometry;default:throw new Error(t+" is invalid")}},n.point=i,n.points=function(t,e,n){return void 0===n&&(n={}),a(t.map(function(t){return i(t,e)}),n)},n.polygon=o,n.polygons=function(t,e,n){return void 0===n&&(n={}),a(t.map(function(t){return o(t,e)}),n)},n.lineString=s,n.lineStrings=function(t,e,n){return void 0===n&&(n={}),a(t.map(function(t){return s(t,e)}),n)},n.featureCollection=a,n.multiLineString=l,n.multiPoint=u,n.multiPolygon=h,n.geometryCollection=function(t,e,n){return void 0===n&&(n={}),r({type:"GeometryCollection",geometries:t},e,n)},n.round=function(t,e){if(void 0===e&&(e=0),e&&!(e>=0))throw new Error("precision must be a positive number");var n=Math.pow(10,e||0);return Math.round(t*n)/n},n.radiansToLength=c,n.lengthToRadians=f,n.lengthToDegrees=function(t,e){return p(f(t,e))},n.bearingToAzimuth=function(t){var e=t%360;return e<0&&(e+=360),e},n.radiansToDegrees=p,n.degreesToRadians=function(t){return t%360*Math.PI/180},n.convertLength=function(t,e,n){if(void 0===e&&(e="kilometers"),void 0===n&&(n="kilometers"),!(t>=0))throw new Error("length must be a positive number");return c(f(t,e),n)},n.convertArea=function(t,e,r){if(void 0===e&&(e="meters"),void 0===r&&(r="kilometers"),!(t>=0))throw new Error("area must be a positive number");var i=n.areaFactors[e];if(!i)throw new Error("invalid original units");var o=n.areaFactors[r];if(!o)throw new Error("invalid final units");return t/i*o},n.isNumber=d,n.isObject=function(t){return!!t&&t.constructor===Object},n.validateBBox=function(t){if(!t)throw new Error("bbox is required");if(!Array.isArray(t))throw new Error("bbox must be an Array");if(4!==t.length&&6!==t.length)throw new Error("bbox must be an Array of 4 or 6 numbers");t.forEach(function(t){if(!d(t))throw new Error("bbox must only contain numbers")})},n.validateId=function(t){if(!t)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof t))throw new Error("id must be a number or a string")}},{}],9:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=t("@turf/helpers");n.getCoord=function(t){if(!t)throw new Error("coord is required");if(!Array.isArray(t)){if("Feature"===t.type&&null!==t.geometry&&"Point"===t.geometry.type)return t.geometry.coordinates;if("Point"===t.type)return t.coordinates}if(Array.isArray(t)&&t.length>=2&&!Array.isArray(t[0])&&!Array.isArray(t[1]))return t;throw new Error("coord must be GeoJSON Point or an Array of numbers")},n.getCoords=function(t){if(Array.isArray(t))return t;if("Feature"===t.type){if(null!==t.geometry)return t.geometry.coordinates}else if(t.coordinates)return t.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")},n.containsNumber=function t(e){if(e.length>1&&r.isNumber(e[0])&&r.isNumber(e[1]))return!0;if(Array.isArray(e[0])&&e[0].length)return t(e[0]);throw new Error("coordinates must only contain numbers")},n.geojsonType=function(t,e,n){if(!e||!n)throw new Error("type and name required");if(!t||t.type!==e)throw new Error("Invalid input to "+n+": must be a "+e+", given "+t.type)},n.featureOf=function(t,e,n){if(!t)throw new Error("No feature passed");if(!n)throw new Error(".featureOf() requires a name");if(!t||"Feature"!==t.type||!t.geometry)throw new Error("Invalid input to "+n+", Feature with geometry required");if(!t.geometry||t.geometry.type!==e)throw new Error("Invalid input to "+n+": must be a "+e+", given "+t.geometry.type)},n.collectionOf=function(t,e,n){if(!t)throw new Error("No featureCollection passed");if(!n)throw new Error(".collectionOf() requires a name");if(!t||"FeatureCollection"!==t.type)throw new Error("Invalid input to "+n+", FeatureCollection required");for(var r=0,i=t.features;r<i.length;r++){var o=i[r];if(!o||"Feature"!==o.type||!o.geometry)throw new Error("Invalid input to "+n+", Feature with geometry required");if(!o.geometry||o.geometry.type!==e)throw new Error("Invalid input to "+n+": must be a "+e+", given "+o.geometry.type)}},n.getGeom=function(t){return"Feature"===t.type?t.geometry:t},n.getType=function(t,e){return"FeatureCollection"===t.type?"FeatureCollection":"GeometryCollection"===t.type?"GeometryCollection":"Feature"===t.type&&null!==t.geometry?t.geometry.type:t.type}},{"@turf/helpers":8}],10:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=t("@turf/helpers");function i(t,e,n){if(null!==t)for(var r,o,s,a,l,u,h,c,f=0,p=0,d=t.type,g="FeatureCollection"===d,v="Feature"===d,m=g?t.features.length:1,y=0;y<m;y++){l=(c=!!(h=g?t.features[y].geometry:v?t.geometry:t)&&"GeometryCollection"===h.type)?h.geometries.length:1;for(var x=0;x<l;x++){var b=0,_=0;if(null!==(a=c?h.geometries[x]:h)){u=a.coordinates;var w=a.type;switch(f=!n||"Polygon"!==w&&"MultiPolygon"!==w?0:1,w){case null:break;case"Point":if(!1===e(u,p,y,b,_))return!1;p++,b++;break;case"LineString":case"MultiPoint":for(r=0;r<u.length;r++){if(!1===e(u[r],p,y,b,_))return!1;p++,"MultiPoint"===w&&b++}"LineString"===w&&b++;break;case"Polygon":case"MultiLineString":for(r=0;r<u.length;r++){for(o=0;o<u[r].length-f;o++){if(!1===e(u[r][o],p,y,b,_))return!1;p++}"MultiLineString"===w&&b++,"Polygon"===w&&_++}"Polygon"===w&&b++;break;case"MultiPolygon":for(r=0;r<u.length;r++){for(_=0,o=0;o<u[r].length;o++){for(s=0;s<u[r][o].length-f;s++){if(!1===e(u[r][o][s],p,y,b,_))return!1;p++}_++}b++}break;case"GeometryCollection":for(r=0;r<a.geometries.length;r++)if(!1===i(a.geometries[r],e,n))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function o(t,e){var n;switch(t.type){case"FeatureCollection":for(n=0;n<t.features.length&&!1!==e(t.features[n].properties,n);n++);break;case"Feature":e(t.properties,0)}}function s(t,e){if("Feature"===t.type)e(t,0);else if("FeatureCollection"===t.type)for(var n=0;n<t.features.length&&!1!==e(t.features[n],n);n++);}function a(t,e){var n,r,i,o,s,a,l,u,h,c,f=0,p="FeatureCollection"===t.type,d="Feature"===t.type,g=p?t.features.length:1;for(n=0;n<g;n++){for(a=p?t.features[n].geometry:d?t.geometry:t,u=p?t.features[n].properties:d?t.properties:{},h=p?t.features[n].bbox:d?t.bbox:void 0,c=p?t.features[n].id:d?t.id:void 0,s=(l=!!a&&"GeometryCollection"===a.type)?a.geometries.length:1,i=0;i<s;i++)if(null!==(o=l?a.geometries[i]:a))switch(o.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===e(o,f,u,h,c))return!1;break;case"GeometryCollection":for(r=0;r<o.geometries.length;r++)if(!1===e(o.geometries[r],f,u,h,c))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===e(null,f,u,h,c))return!1;f++}}function l(t,e){a(t,function(t,n,i,o,s){var a,l=null===t?null:t.type;switch(l){case null:case"Point":case"LineString":case"Polygon":return!1!==e(r.feature(t,i,{bbox:o,id:s}),n,0)&&void 0}switch(l){case"MultiPoint":a="Point";break;case"MultiLineString":a="LineString";break;case"MultiPolygon":a="Polygon"}for(var u=0;u<t.coordinates.length;u++){var h={type:a,coordinates:t.coordinates[u]};if(!1===e(r.feature(h,i),n,u))return!1}})}function u(t,e){l(t,function(t,n,o){var s=0;if(t.geometry){var a=t.geometry.type;if("Point"!==a&&"MultiPoint"!==a){var l,u=0,h=0,c=0;return!1!==i(t,function(i,a,f,p,d){if(void 0===l||n>u||p>h||d>c)return l=i,u=n,h=p,c=d,void(s=0);var g=r.lineString([l,i],t.properties);if(!1===e(g,n,o,d,s))return!1;s++,l=i})&&void 0}}})}function h(t,e){if(!t)throw new Error("geojson is required");l(t,function(t,n,i){if(null!==t.geometry){var o=t.geometry.type,s=t.geometry.coordinates;switch(o){case"LineString":if(!1===e(t,n,i,0,0))return!1;break;case"Polygon":for(var a=0;a<s.length;a++)if(!1===e(r.lineString(s[a],t.properties),n,i,a))return!1}}})}n.coordEach=i,n.coordReduce=function(t,e,n,r){var o=n;return i(t,function(t,r,i,s,a){o=0===r&&void 0===n?t:e(o,t,r,i,s,a)},r),o},n.propEach=o,n.propReduce=function(t,e,n){var r=n;return o(t,function(t,i){r=0===i&&void 0===n?t:e(r,t,i)}),r},n.featureEach=s,n.featureReduce=function(t,e,n){var r=n;return s(t,function(t,i){r=0===i&&void 0===n?t:e(r,t,i)}),r},n.coordAll=function(t){var e=[];return i(t,function(t){e.push(t)}),e},n.geomEach=a,n.geomReduce=function(t,e,n){var r=n;return a(t,function(t,i,o,s,a){r=0===i&&void 0===n?t:e(r,t,i,o,s,a)}),r},n.flattenEach=l,n.flattenReduce=function(t,e,n){var r=n;return l(t,function(t,i,o){r=0===i&&0===o&&void 0===n?t:e(r,t,i,o)}),r},n.segmentEach=u,n.segmentReduce=function(t,e,n){var r=n,i=!1;return u(t,function(t,o,s,a,l){r=!1===i&&void 0===n?t:e(r,t,o,s,a,l),i=!0}),r},n.lineEach=h,n.lineReduce=function(t,e,n){var r=n;return h(t,function(t,i,o,s){r=0===i&&void 0===n?t:e(r,t,i,o,s)}),r},n.findSegment=function(t,e){if(e=e||{},!r.isObject(e))throw new Error("options is invalid");var n,i=e.featureIndex||0,o=e.multiFeatureIndex||0,s=e.geometryIndex||0,a=e.segmentIndex||0,l=e.properties;switch(t.type){case"FeatureCollection":i<0&&(i=t.features.length+i),l=l||t.features[i].properties,n=t.features[i].geometry;break;case"Feature":l=l||t.properties,n=t.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":n=t;break;default:throw new Error("geojson is invalid")}if(null===n)return null;var u=n.coordinates;switch(n.type){case"Point":case"MultiPoint":return null;case"LineString":return a<0&&(a=u.length+a-1),r.lineString([u[a],u[a+1]],l,e);case"Polygon":return s<0&&(s=u.length+s),a<0&&(a=u[s].length+a-1),r.lineString([u[s][a],u[s][a+1]],l,e);case"MultiLineString":return o<0&&(o=u.length+o),a<0&&(a=u[o].length+a-1),r.lineString([u[o][a],u[o][a+1]],l,e);case"MultiPolygon":return o<0&&(o=u.length+o),s<0&&(s=u[o].length+s),a<0&&(a=u[o][s].length-a-1),r.lineString([u[o][s][a],u[o][s][a+1]],l,e)}throw new Error("geojson is invalid")},n.findPoint=function(t,e){if(e=e||{},!r.isObject(e))throw new Error("options is invalid");var n,i=e.featureIndex||0,o=e.multiFeatureIndex||0,s=e.geometryIndex||0,a=e.coordIndex||0,l=e.properties;switch(t.type){case"FeatureCollection":i<0&&(i=t.features.length+i),l=l||t.features[i].properties,n=t.features[i].geometry;break;case"Feature":l=l||t.properties,n=t.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":n=t;break;default:throw new Error("geojson is invalid")}if(null===n)return null;var u=n.coordinates;switch(n.type){case"Point":return r.point(u,l,e);case"MultiPoint":return o<0&&(o=u.length+o),r.point(u[o],l,e);case"LineString":return a<0&&(a=u.length+a),r.point(u[a],l,e);case"Polygon":return s<0&&(s=u.length+s),a<0&&(a=u[s].length+a),r.point(u[s][a],l,e);case"MultiLineString":return o<0&&(o=u.length+o),a<0&&(a=u[o].length+a),r.point(u[o][a],l,e);case"MultiPolygon":return o<0&&(o=u.length+o),s<0&&(s=u[o].length+s),a<0&&(a=u[o][s].length-a),r.point(u[o][s][a],l,e)}throw new Error("geojson is invalid")}},{"@turf/helpers":8}],11:[function(t,e,n){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0});var i=r(t("polygon-clipping")),o=t("@turf/invariant"),s=t("@turf/helpers");n.default=function(t,e,n){void 0===n&&(n={});var r=o.getGeom(t),a=o.getGeom(e),l=i.default.union(r.coordinates,a.coordinates);return 0===l.length?null:1===l.length?s.polygon(l[0],n.properties):s.multiPolygon(l,n.properties)}},{"@turf/helpers":8,"@turf/invariant":9,"polygon-clipping":20}],12:[function(t,e,n){"use strict";var r=t("rbush"),i=t("tinyqueue"),o=t("point-in-polygon");const s=t("robust-predicates/umd/orient2d.min.js").orient2d;function a(t,e,n){e=Math.max(0,void 0===e?2:e),n=n||0;var i=function(t){for(var e=t[0],n=t[0],r=t[0],i=t[0],s=0;s<t.length;s++){var a=t[s];a[0]<e[0]&&(e=a),a[0]>r[0]&&(r=a),a[1]<n[1]&&(n=a),a[1]>i[1]&&(i=a)}var l=[e,n,r,i],u=l.slice();for(s=0;s<t.length;s++)o(t[s],l)||u.push(t[s]);return function(t){t.sort(x);for(var e=[],n=0;n<t.length;n++){for(;e.length>=2&&p(e[e.length-2],e[e.length-1],t[n])<=0;)e.pop();e.push(t[n])}for(var r=[],i=t.length-1;i>=0;i--){for(;r.length>=2&&p(r[r.length-2],r[r.length-1],t[i])<=0;)r.pop();r.push(t[i])}return r.pop(),e.pop(),e.concat(r)}(u)}(t),s=new r(16);s.toBBox=function(t){return{minX:t[0],minY:t[1],maxX:t[0],maxY:t[1]}},s.compareMinX=function(t,e){return t[0]-e[0]},s.compareMinY=function(t,e){return t[1]-e[1]},s.load(t);for(var a,u=[],h=0;h<i.length;h++){var c=i[h];s.remove(c),a=g(c,a),u.push(a)}var f=new r(16);for(h=0;h<u.length;h++)f.insert(d(u[h]));for(var m=e*e,y=n*n;u.length;){var b=u.shift(),_=b.p,w=b.next.p,E=v(_,w);if(!(E<y)){var k=E/m;(c=l(s,b.prev.p,_,w,b.next.next.p,k,f))&&Math.min(v(c,_),v(c,w))<=k&&(u.push(b),u.push(g(c,b)),s.remove(c),f.remove(b),f.insert(d(b)),f.insert(d(b.next)))}}b=a;var S=[];do{S.push(b.p),b=b.next}while(b!==a);return S.push(b.p),S}function l(t,e,n,r,o,s,a){for(var l=new i([],u),c=t.data;c;){for(var p=0;p<c.children.length;p++){var d=c.children[p],g=c.leaf?m(d,n,r):h(n,r,d);g>s||l.push({node:d,dist:g})}for(;l.length&&!l.peek().node.children;){var v=l.pop(),y=v.node,x=m(y,e,n),b=m(y,r,o);if(v.dist<x&&v.dist<b&&f(n,y,a)&&f(r,y,a))return y}(c=l.pop())&&(c=c.node)}return null}function u(t,e){return t.dist-e.dist}function h(t,e,n){if(c(t,n)||c(e,n))return 0;var r=y(t[0],t[1],e[0],e[1],n.minX,n.minY,n.maxX,n.minY);if(0===r)return 0;var i=y(t[0],t[1],e[0],e[1],n.minX,n.minY,n.minX,n.maxY);if(0===i)return 0;var o=y(t[0],t[1],e[0],e[1],n.maxX,n.minY,n.maxX,n.maxY);if(0===o)return 0;var s=y(t[0],t[1],e[0],e[1],n.minX,n.maxY,n.maxX,n.maxY);return 0===s?0:Math.min(r,i,o,s)}function c(t,e){return t[0]>=e.minX&&t[0]<=e.maxX&&t[1]>=e.minY&&t[1]<=e.maxY}function f(t,e,n){for(var r,i,o,s,a=Math.min(t[0],e[0]),l=Math.min(t[1],e[1]),u=Math.max(t[0],e[0]),h=Math.max(t[1],e[1]),c=n.search({minX:a,minY:l,maxX:u,maxY:h}),f=0;f<c.length;f++)if(r=c[f].p,i=c[f].next.p,o=t,r!==(s=e)&&i!==o&&p(r,i,o)>0!=p(r,i,s)>0&&p(o,s,r)>0!=p(o,s,i)>0)return!1;return!0}function p(t,e,n){return s(t[0],t[1],e[0],e[1],n[0],n[1])}function d(t){var e=t.p,n=t.next.p;return t.minX=Math.min(e[0],n[0]),t.minY=Math.min(e[1],n[1]),t.maxX=Math.max(e[0],n[0]),t.maxY=Math.max(e[1],n[1]),t}function g(t,e){var n={p:t,prev:null,next:null,minX:0,minY:0,maxX:0,maxY:0};return e?(n.next=e.next,n.prev=e,e.next.prev=n,e.next=n):(n.prev=n,n.next=n),n}function v(t,e){var n=t[0]-e[0],r=t[1]-e[1];return n*n+r*r}function m(t,e,n){var r=e[0],i=e[1],o=n[0]-r,s=n[1]-i;if(0!==o||0!==s){var a=((t[0]-r)*o+(t[1]-i)*s)/(o*o+s*s);a>1?(r=n[0],i=n[1]):a>0&&(r+=o*a,i+=s*a)}return(o=t[0]-r)*o+(s=t[1]-i)*s}function y(t,e,n,r,i,o,s,a){var l,u,h,c,f=n-t,p=r-e,d=s-i,g=a-o,v=t-i,m=e-o,y=f*f+p*p,x=f*d+p*g,b=d*d+g*g,_=f*v+p*m,w=d*v+g*m,E=y*b-x*x,k=E,S=E;0===E?(u=0,k=1,c=w,S=b):(c=y*w-x*_,(u=x*w-b*_)<0?(u=0,c=w,S=b):u>k&&(u=k,c=w+x,S=b)),c<0?(c=0,-_<0?u=0:-_>y?u=k:(u=-_,k=y)):c>S&&(c=S,-_+x<0?u=0:-_+x>y?u=k:(u=-_+x,k=y)),l=0===u?0:u/k;var M=(1-(h=0===c?0:c/S))*i+h*s-((1-l)*t+l*n),P=(1-h)*o+h*a-((1-l)*e+l*r);return M*M+P*P}function x(t,e){return t[0]===e[0]?t[1]-e[1]:t[0]-e[0]}e.exports=a,e.exports.default=a},{"point-in-polygon":18,rbush:22,"robust-predicates/umd/orient2d.min.js":23,tinyqueue:27}],13:[function(t,e,n){function r(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function i(t){return"function"==typeof t}function o(t){return"object"==typeof t&&null!==t}function s(t){return void 0===t}e.exports=r,r.EventEmitter=r,r.prototype._events=void 0,r.prototype._maxListeners=void 0,r.defaultMaxListeners=10,r.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||isNaN(t))throw TypeError("n must be a positive number");return this._maxListeners=t,this},r.prototype.emit=function(t){var e,n,r,a,l,u;if(this._events||(this._events={}),"error"===t&&(!this._events.error||o(this._events.error)&&!this._events.error.length)){if((e=arguments[1])instanceof Error)throw e;var h=new Error('Uncaught, unspecified "error" event. ('+e+")");throw h.context=e,h}if(s(n=this._events[t]))return!1;if(i(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:a=Array.prototype.slice.call(arguments,1),n.apply(this,a)}else if(o(n))for(a=Array.prototype.slice.call(arguments,1),r=(u=n.slice()).length,l=0;l<r;l++)u[l].apply(this,a);return!0},r.prototype.addListener=function(t,e){var n;if(!i(e))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",t,i(e.listener)?e.listener:e),this._events[t]?o(this._events[t])?this._events[t].push(e):this._events[t]=[this._events[t],e]:this._events[t]=e,o(this._events[t])&&!this._events[t].warned&&(n=s(this._maxListeners)?r.defaultMaxListeners:this._maxListeners)&&n>0&&this._events[t].length>n&&(this._events[t].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),"function"==typeof console.trace&&console.trace()),this},r.prototype.on=r.prototype.addListener,r.prototype.once=function(t,e){if(!i(e))throw TypeError("listener must be a function");var n=!1;function r(){this.removeListener(t,r),n||(n=!0,e.apply(this,arguments))}return r.listener=e,this.on(t,r),this},r.prototype.removeListener=function(t,e){var n,r,s,a;if(!i(e))throw TypeError("listener must be a function");if(!this._events||!this._events[t])return this;if(s=(n=this._events[t]).length,r=-1,n===e||i(n.listener)&&n.listener===e)delete this._events[t],this._events.removeListener&&this.emit("removeListener",t,e);else if(o(n)){for(a=s;a-- >0;)if(n[a]===e||n[a].listener&&n[a].listener===e){r=a;break}if(r<0)return this;1===n.length?(n.length=0,delete this._events[t]):n.splice(r,1),this._events.removeListener&&this.emit("removeListener",t,e)}return this},r.prototype.removeAllListeners=function(t){var e,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[t]&&delete this._events[t],this;if(0===arguments.length){for(e in this._events)"removeListener"!==e&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events={},this}if(i(n=this._events[t]))this.removeListener(t,n);else if(n)for(;n.length;)this.removeListener(t,n[n.length-1]);return delete this._events[t],this},r.prototype.listeners=function(t){return this._events&&this._events[t]?i(this._events[t])?[this._events[t]]:this._events[t].slice():[]},r.prototype.listenerCount=function(t){if(this._events){var e=this._events[t];if(i(e))return 1;if(e)return e.length}return 0},r.listenerCount=function(t,e){return t.listenerCount(e)}},{}],14:[function(t,e,n){!function(){var t={};void 0!==n?e.exports=t:this.fuzzy=t,t.simpleFilter=function(e,n){return n.filter(function(n){return t.test(e,n)})},t.test=function(e,n){return null!==t.match(e,n)},t.match=function(t,e,n){n=n||{};var r,i=0,o=[],s=e.length,a=0,l=0,u=n.pre||"",h=n.post||"",c=n.caseSensitive&&e||e.toLowerCase();t=n.caseSensitive&&t||t.toLowerCase();for(var f=0;f<s;f++)r=e[f],c[f]===t[i]?(r=u+r+h,i+=1,l+=1+l):l=0,a+=l,o[o.length]=r;return i===t.length?(a=c===t?1/0:a,{rendered:o.join(""),score:a}):null},t.filter=function(e,n,r){return n&&0!==n.length?"string"!=typeof e?n:(r=r||{},n.reduce(function(n,i,o,s){var a=i;r.extract&&(a=r.extract(i));var l=t.match(e,a,r);return null!=l&&(n[n.length]={string:l.rendered,score:l.score,index:o,original:i}),n},[]).sort(function(t,e){var n=e.score-t.score;return n||t.index-e.index})):[]}}()},{}],15:[function(t,e,n){(function(t){(function(){var n="Expected a function",r=NaN,i="[object Symbol]",o=/^\s+|\s+$/g,s=/^[-+]0x[0-9a-f]+$/i,a=/^0b[01]+$/i,l=/^0o[0-7]+$/i,u=parseInt,h="object"==typeof t&&t&&t.Object===Object&&t,c="object"==typeof self&&self&&self.Object===Object&&self,f=h||c||Function("return this")(),p=Object.prototype.toString,d=Math.max,g=Math.min,v=function(){return f.Date.now()};function m(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function y(t){if("number"==typeof t)return t;if(function(t){return"symbol"==typeof t||function(t){return!!t&&"object"==typeof t}(t)&&p.call(t)==i}(t))return r;if(m(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=m(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(o,"");var n=a.test(t);return n||l.test(t)?u(t.slice(2),n?2:8):s.test(t)?r:+t}e.exports=function(t,e,r){var i,o,s,a,l,u,h=0,c=!1,f=!1,p=!0;if("function"!=typeof t)throw new TypeError(n);function x(e){var n=i,r=o;return i=o=void 0,h=e,a=t.apply(r,n)}function b(t){var n=t-u;return void 0===u||n>=e||n<0||f&&t-h>=s}function _(){var t=v();if(b(t))return w(t);l=setTimeout(_,function(t){var n=e-(t-u);return f?g(n,s-(t-h)):n}(t))}function w(t){return l=void 0,p&&i?x(t):(i=o=void 0,a)}function E(){var t=v(),n=b(t);if(i=arguments,o=this,u=t,n){if(void 0===l)return function(t){return h=t,l=setTimeout(_,e),c?x(t):a}(u);if(f)return l=setTimeout(_,e),x(u)}return void 0===l&&(l=setTimeout(_,e)),a}return e=y(e)||0,m(r)&&(c=!!r.leading,s=(f="maxWait"in r)?d(y(r.maxWait)||0,e):s,p="trailing"in r?!!r.trailing:p),E.cancel=function(){void 0!==l&&clearTimeout(l),h=0,i=u=o=l=void 0},E.flush=function(){return void 0===l?a:w(v())},E}}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],16:[function(t,e,n){"use strict";var r=t("suggestions"),i=t("lodash.debounce"),o=t("xtend"),s=t("events").EventEmitter;function a(t,e){this._eventEmitter=new s,this.options=o({},this.options,t),this.geocodeRequest=e}a.prototype={options:{placeholder:"Search for Place or Address",zoom:16,flyTo:!0,minLength:2,limit:5,fitBoundsOptions:{}},onAdd:function(t){this._map=t,this._onChange=this._onChange.bind(this),this._onKeyDown=this._onKeyDown.bind(this),this._clear=this._clear.bind(this);var e=this.container=document.createElement("div");e.className="mapboxgl-ctrl-generic-geocoder mapboxgl-ctrl";var n=document.createElement("span");n.className="geocoder-icon geocoder-icon-search",this._inputEl=document.createElement("input"),this._inputEl.type="text",this._inputEl.placeholder=this.options.placeholder,this._inputEl.addEventListener("keydown",this._onKeyDown),this._inputEl.addEventListener("change",this._onChange);var i=document.createElement("div");return i.classList.add("geocoder-pin-right"),this._clearEl=document.createElement("button"),this._clearEl.className="geocoder-icon geocoder-icon-close",this._clearEl.setAttribute("aria-label","Clear"),this._clearEl.addEventListener("click",this._clear),this._loadingEl=document.createElement("span"),this._loadingEl.className="geocoder-icon geocoder-icon-loading",i.appendChild(this._clearEl),i.appendChild(this._loadingEl),e.appendChild(n),e.appendChild(this._inputEl),e.appendChild(i),this._typeahead=new r(this._inputEl,[],{filter:!1,minLength:this.options.minLength,limit:this.options.limit}),this._typeahead.getItemValue=function(t){return t.name},e},onRemove:function(){return this.container.parentNode.removeChild(this.container),this._map=null,this},_onKeyDown:i(function(t){if(!t.target.value)return this._clearEl.style.display="none";-1===[9,27,37,39,13,38,40].indexOf(t.keyCode)&&t.target.value.length>=this.options.minLength&&this._geocode(t.target.value)},500),_onChange:function(){this._inputEl.value&&(this._clearEl.style.display="block");var t=this._typeahead.selected;if(t){if(this.options.flyTo){var e=t.bbox;e?this._map.fitBounds([[e[0],e[1]],[e[2],e[3]]],this.options.fitBoundsOptions):this._map.flyTo({center:[t.lon,t.lat],zoom:this.options.zoom})}this._eventEmitter.emit("result",{result:t})}},_geocode:function(t){this._loadingEl.style.display="block",this._eventEmitter.emit("loading",{query:t}),this.geocodeRequest(t,this._map.getBounds(),this.options).then(function(t){this._loadingEl.style.display="none",t.length?(t=t.slice(0,this.options.limit),this._clearEl.style.display="block"):(this._clearEl.style.display="none",this._typeahead.selected=null),this._eventEmitter.emit("results",t),this._typeahead.update(t)}.bind(this)).catch(function(t){this._loadingEl.style.display="none",this._eventEmitter.emit("error",{text:t.message,err:t})}.bind(this))},_clear:function(t){t&&t.preventDefault(),this._inputEl.value="",this._typeahead.selected=null,this._typeahead.clear(),this._onChange(),this._inputEl.focus(),this._clearEl.style.display="none",this._eventEmitter.emit("clear")},on:function(t,e){return this._eventEmitter.on(t,e),this},off:function(t,e){return this._eventEmitter.removeListener(t,e),this}},e.exports=a},{events:13,"lodash.debounce":15,suggestions:24,xtend:28}],17:[function(t,e,n){e.exports=function(t,e,n,r){var i=t[0],o=t[1],s=!1;void 0===n&&(n=0),void 0===r&&(r=e.length);for(var a=(r-n)/2,l=0,u=a-1;l<a;u=l++){var h=e[n+2*l+0],c=e[n+2*l+1],f=e[n+2*u+0],p=e[n+2*u+1];c>o!=p>o&&i<(f-h)*(o-c)/(p-c)+h&&(s=!s)}return s}},{}],18:[function(t,e,n){var r=t("./flat.js"),i=t("./nested.js");e.exports=function(t,e,n,o){return e.length>0&&Array.isArray(e[0])?i(t,e,n,o):r(t,e,n,o)},e.exports.nested=i,e.exports.flat=r},{"./flat.js":17,"./nested.js":19}],19:[function(t,e,n){e.exports=function(t,e,n,r){var i=t[0],o=t[1],s=!1;void 0===n&&(n=0),void 0===r&&(r=e.length);for(var a=r-n,l=0,u=a-1;l<a;u=l++){var h=e[l+n][0],c=e[l+n][1],f=e[u+n][0],p=e[u+n][1];c>o!=p>o&&i<(f-h)*(o-c)/(p-c)+h&&(s=!s)}return s}},{}],20:[function(t,e,n){(function(t){(function(){var r,i;r=this,i=function(){"use strict";function e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function r(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),t}var i=function(){return function(t,e){this.next=null,this.key=t,this.data=e,this.left=null,this.right=null}}();function o(t,e){return t>e?1:t<e?-1:0}function s(t,e,n){for(var r=new i(null,null),o=r,s=r;;){var a=n(t,e.key);if(a<0){if(null===e.left)break;if(n(t,e.left.key)<0){var l=e.left;if(e.left=l.right,l.right=e,null===(e=l).left)break}s.left=e,s=e,e=e.left}else{if(!(a>0))break;if(null===e.right)break;if(n(t,e.right.key)>0){l=e.right;if(e.right=l.left,l.left=e,null===(e=l).right)break}o.right=e,o=e,e=e.right}}return o.right=e.left,s.left=e.right,e.left=r.right,e.right=r.left,e}function a(t,e,n,r){var o=new i(t,e);if(null===n)return o.left=o.right=null,o;var a=r(t,(n=s(t,n,r)).key);return a<0?(o.left=n.left,o.right=n,n.left=null):a>=0&&(o.right=n.right,o.left=n,n.right=null),o}function l(t,e,n){var r=null,i=null;if(e){var o=n((e=s(t,e,n)).key,t);0===o?(r=e.left,i=e.right):o<0?(i=e.right,e.right=null,r=e):(r=e.left,e.left=null,i=e)}return{left:r,right:i}}var u=function(){function t(t){void 0===t&&(t=o),this._root=null,this._size=0,this._comparator=t}return t.prototype.insert=function(t,e){return this._size++,this._root=a(t,e,this._root,this._comparator)},t.prototype.add=function(t,e){var n=new i(t,e);null===this._root&&(n.left=n.right=null,this._size++,this._root=n);var r=this._comparator,o=s(t,this._root,r),a=r(t,o.key);return 0===a?this._root=o:(a<0?(n.left=o.left,n.right=o,o.left=null):a>0&&(n.right=o.right,n.left=o,o.right=null),this._size++,this._root=n),this._root},t.prototype.remove=function(t){this._root=this._remove(t,this._root,this._comparator)},t.prototype._remove=function(t,e,n){var r;return null===e?null:0===n(t,(e=s(t,e,n)).key)?(null===e.left?r=e.right:(r=s(t,e.left,n)).right=e.right,this._size--,r):e},t.prototype.pop=function(){var t=this._root;if(t){for(;t.left;)t=t.left;return this._root=s(t.key,this._root,this._comparator),this._root=this._remove(t.key,this._root,this._comparator),{key:t.key,data:t.data}}return null},t.prototype.findStatic=function(t){for(var e=this._root,n=this._comparator;e;){var r=n(t,e.key);if(0===r)return e;e=r<0?e.left:e.right}return null},t.prototype.find=function(t){return this._root&&(this._root=s(t,this._root,this._comparator),0!==this._comparator(t,this._root.key))?null:this._root},t.prototype.contains=function(t){for(var e=this._root,n=this._comparator;e;){var r=n(t,e.key);if(0===r)return!0;e=r<0?e.left:e.right}return!1},t.prototype.forEach=function(t,e){for(var n=this._root,r=[],i=!1;!i;)null!==n?(r.push(n),n=n.left):0!==r.length?(n=r.pop(),t.call(e,n),n=n.right):i=!0;return this},t.prototype.range=function(t,e,n,r){for(var i=[],o=this._comparator,s=this._root;0!==i.length||s;)if(s)i.push(s),s=s.left;else{if(o((s=i.pop()).key,e)>0)break;if(o(s.key,t)>=0&&n.call(r,s))return this;s=s.right}return this},t.prototype.keys=function(){var t=[];return this.forEach(function(e){var n=e.key;return t.push(n)}),t},t.prototype.values=function(){var t=[];return this.forEach(function(e){var n=e.data;return t.push(n)}),t},t.prototype.min=function(){return this._root?this.minNode(this._root).key:null},t.prototype.max=function(){return this._root?this.maxNode(this._root).key:null},t.prototype.minNode=function(t){if(void 0===t&&(t=this._root),t)for(;t.left;)t=t.left;return t},t.prototype.maxNode=function(t){if(void 0===t&&(t=this._root),t)for(;t.right;)t=t.right;return t},t.prototype.at=function(t){for(var e=this._root,n=!1,r=0,i=[];!n;)if(e)i.push(e),e=e.left;else if(i.length>0){if(e=i.pop(),r===t)return e;r++,e=e.right}else n=!0;return null},t.prototype.next=function(t){var e=this._root,n=null;if(t.right){for(n=t.right;n.left;)n=n.left;return n}for(var r=this._comparator;e;){var i=r(t.key,e.key);if(0===i)break;i<0?(n=e,e=e.left):e=e.right}return n},t.prototype.prev=function(t){var e=this._root,n=null;if(null!==t.left){for(n=t.left;n.right;)n=n.right;return n}for(var r=this._comparator;e;){var i=r(t.key,e.key);if(0===i)break;i<0?e=e.left:(n=e,e=e.right)}return n},t.prototype.clear=function(){return this._root=null,this._size=0,this},t.prototype.toList=function(){return function(t){var e=t,n=[],r=!1,o=new i(null,null),s=o;for(;!r;)e?(n.push(e),e=e.left):n.length>0?e=(e=s=s.next=n.pop()).right:r=!0;return s.next=null,o.next}(this._root)},t.prototype.load=function(t,e,n){void 0===e&&(e=[]),void 0===n&&(n=!1);var r=t.length,o=this._comparator;if(n&&function t(e,n,r,i,o){if(r>=i)return;var s=e[r+i>>1];var a=r-1;var l=i+1;for(;;){do{a++}while(o(e[a],s)<0);do{l--}while(o(e[l],s)>0);if(a>=l)break;var u=e[a];e[a]=e[l],e[l]=u,u=n[a],n[a]=n[l],n[l]=u}t(e,n,r,l,o);t(e,n,l+1,i,o)}(t,e,0,r-1,o),null===this._root)this._root=function t(e,n,r,o){var s=o-r;if(s>0){var a=r+Math.floor(s/2),l=e[a],u=n[a],h=new i(l,u);return h.left=t(e,n,r,a),h.right=t(e,n,a+1,o),h}return null}(t,e,0,r),this._size=r;else{var s=function(t,e,n){var r=new i(null,null),o=r,s=t,a=e;for(;null!==s&&null!==a;)n(s.key,a.key)<0?(o.next=s,s=s.next):(o.next=a,a=a.next),o=o.next;null!==s?o.next=s:null!==a&&(o.next=a);return r.next}(this.toList(),function(t,e){for(var n=new i(null,null),r=n,o=0;o<t.length;o++)r=r.next=new i(t[o],e[o]);return r.next=null,n.next}(t,e),o);r=this._size+r,this._root=function t(e,n,r){var i=r-n;if(i>0){var o=n+Math.floor(i/2),s=t(e,n,o),a=e.head;return a.left=s,e.head=e.head.next,a.right=t(e,o+1,r),a}return null}({head:s},0,r)}return this},t.prototype.isEmpty=function(){return null===this._root},Object.defineProperty(t.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),t.prototype.toString=function(t){void 0===t&&(t=function(t){return String(t.key)});var e=[];return function t(e,n,r,i,o){if(e){i(n+(r?" ":" ")+o(e)+"\n");var s=n+(r?"    ":"   ");e.left&&t(e.left,s,!1,i,o),e.right&&t(e.right,s,!0,i,o)}}(this._root,"",!0,function(t){return e.push(t)},t),e.join("")},t.prototype.update=function(t,e,n){var r=this._comparator,i=l(t,this._root,r),o=i.left,u=i.right;r(t,e)<0?u=a(e,n,u,r):o=a(e,n,o,r),this._root=function(t,e,n){return null===e?t:null===t?e:((e=s(t.key,e,n)).left=t,e)}(o,u,r)},t.prototype.split=function(t){return l(t,this._root,this._comparator)},t}();var h=function(t,e){return t.ll.x<=e.x&&e.x<=t.ur.x&&t.ll.y<=e.y&&e.y<=t.ur.y},c=function(t,e){if(e.ur.x<t.ll.x||t.ur.x<e.ll.x||e.ur.y<t.ll.y||t.ur.y<e.ll.y)return null;var n=t.ll.x<e.ll.x?e.ll.x:t.ll.x,r=t.ur.x<e.ur.x?t.ur.x:e.ur.x;return{ll:{x:n,y:t.ll.y<e.ll.y?e.ll.y:t.ll.y},ur:{x:r,y:t.ur.y<e.ur.y?t.ur.y:e.ur.y}}},f=Number.EPSILON;void 0===f&&(f=Math.pow(2,-52));var p=f*f,d=function(t,e){if(-f<t&&t<f&&-f<e&&e<f)return 0;var n=t-e;return n*n<p*t*e?0:t<e?-1:1},g=function(){function t(){e(this,t),this.reset()}return r(t,[{key:"reset",value:function(){this.xRounder=new v,this.yRounder=new v}},{key:"round",value:function(t,e){return{x:this.xRounder.round(t),y:this.yRounder.round(e)}}}]),t}(),v=function(){function t(){e(this,t),this.tree=new u,this.round(0)}return r(t,[{key:"round",value:function(t){var e=this.tree.add(t),n=this.tree.prev(e);if(null!==n&&0===d(e.key,n.key))return this.tree.remove(t),n.key;var r=this.tree.next(e);return null!==r&&0===d(e.key,r.key)?(this.tree.remove(t),r.key):t}}]),t}(),m=new g,y=function(t,e){return t.x*e.y-t.y*e.x},x=function(t,e){return t.x*e.x+t.y*e.y},b=function(t,e,n){var r={x:e.x-t.x,y:e.y-t.y},i={x:n.x-t.x,y:n.y-t.y},o=y(r,i);return d(o,0)},_=function(t){return Math.sqrt(x(t,t))},w=function(t,e,n){return 0===e.y?null:{x:t.x+e.x/e.y*(n-t.y),y:n}},E=function(t,e,n){return 0===e.x?null:{x:n,y:t.y+e.y/e.x*(n-t.x)}},k=function(){function t(n,r){e(this,t),void 0===n.events?n.events=[this]:n.events.push(this),this.point=n,this.isLeft=r}return r(t,null,[{key:"compare",value:function(e,n){var r=t.comparePoints(e.point,n.point);return 0!==r?r:(e.point!==n.point&&e.link(n),e.isLeft!==n.isLeft?e.isLeft?1:-1:M.compare(e.segment,n.segment))}},{key:"comparePoints",value:function(t,e){return t.x<e.x?-1:t.x>e.x?1:t.y<e.y?-1:t.y>e.y?1:0}}]),r(t,[{key:"link",value:function(t){if(t.point===this.point)throw new Error("Tried to link already linked events");for(var e=t.point.events,n=0,r=e.length;n<r;n++){var i=e[n];this.point.events.push(i),i.point=this.point}this.checkForConsuming()}},{key:"checkForConsuming",value:function(){for(var t=this.point.events.length,e=0;e<t;e++){var n=this.point.events[e];if(void 0===n.segment.consumedBy)for(var r=e+1;r<t;r++){var i=this.point.events[r];void 0===i.consumedBy&&(n.otherSE.point.events===i.otherSE.point.events&&n.segment.consume(i.segment))}}}},{key:"getAvailableLinkedEvents",value:function(){for(var t=[],e=0,n=this.point.events.length;e<n;e++){var r=this.point.events[e];r!==this&&!r.segment.ringOut&&r.segment.isInResult()&&t.push(r)}return t}},{key:"getLeftmostComparator",value:function(t){var e=this,n=new Map,r=function(r){var i,o,s,a,l,u=r.otherSE;n.set(r,{sine:(i=e.point,o=t.point,s=u.point,a={x:o.x-i.x,y:o.y-i.y},l={x:s.x-i.x,y:s.y-i.y},y(l,a)/_(l)/_(a)),cosine:function(t,e,n){var r={x:e.x-t.x,y:e.y-t.y},i={x:n.x-t.x,y:n.y-t.y};return x(i,r)/_(i)/_(r)}(e.point,t.point,u.point)})};return function(t,e){n.has(t)||r(t),n.has(e)||r(e);var i=n.get(t),o=i.sine,s=i.cosine,a=n.get(e),l=a.sine,u=a.cosine;return o>=0&&l>=0?s<u?1:s>u?-1:0:o<0&&l<0?s<u?-1:s>u?1:0:l<o?-1:l>o?1:0}}}]),t}(),S=0,M=function(){function t(n,r,i,o){e(this,t),this.id=++S,this.leftSE=n,n.segment=this,n.otherSE=r,this.rightSE=r,r.segment=this,r.otherSE=n,this.rings=i,this.windings=o}return r(t,null,[{key:"compare",value:function(t,e){var n=t.leftSE.point.x,r=e.leftSE.point.x,i=t.rightSE.point.x,o=e.rightSE.point.x;if(o<n)return 1;if(i<r)return-1;var s=t.leftSE.point.y,a=e.leftSE.point.y,l=t.rightSE.point.y,u=e.rightSE.point.y;if(n<r){if(a<s&&a<l)return 1;if(a>s&&a>l)return-1;var h=t.comparePoint(e.leftSE.point);if(h<0)return 1;if(h>0)return-1;var c=e.comparePoint(t.rightSE.point);return 0!==c?c:-1}if(n>r){if(s<a&&s<u)return-1;if(s>a&&s>u)return 1;var f=e.comparePoint(t.leftSE.point);if(0!==f)return f;var p=t.comparePoint(e.rightSE.point);return p<0?1:p>0?-1:1}if(s<a)return-1;if(s>a)return 1;if(i<o){var d=e.comparePoint(t.rightSE.point);if(0!==d)return d}if(i>o){var g=t.comparePoint(e.rightSE.point);if(g<0)return 1;if(g>0)return-1}if(i!==o){var v=l-s,m=i-n,y=u-a,x=o-r;if(v>m&&y<x)return 1;if(v<m&&y>x)return-1}return i>o?1:i<o?-1:l<u?-1:l>u?1:t.id<e.id?-1:t.id>e.id?1:0}}]),r(t,[{key:"replaceRightSE",value:function(t){this.rightSE=t,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}},{key:"bbox",value:function(){var t=this.leftSE.point.y,e=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:t<e?t:e},ur:{x:this.rightSE.point.x,y:t>e?t:e}}}},{key:"vector",value:function(){return{x:this.rightSE.point.x-this.leftSE.point.x,y:this.rightSE.point.y-this.leftSE.point.y}}},{key:"isAnEndpoint",value:function(t){return t.x===this.leftSE.point.x&&t.y===this.leftSE.point.y||t.x===this.rightSE.point.x&&t.y===this.rightSE.point.y}},{key:"comparePoint",value:function(t){if(this.isAnEndpoint(t))return 0;var e=this.leftSE.point,n=this.rightSE.point,r=this.vector();if(e.x===n.x)return t.x===e.x?0:t.x<e.x?1:-1;var i=(t.y-e.y)/r.y,o=e.x+i*r.x;if(t.x===o)return 0;var s=(t.x-e.x)/r.x,a=e.y+s*r.y;return t.y===a?0:t.y<a?-1:1}},{key:"getIntersection",value:function(t){var e=this.bbox(),n=t.bbox(),r=c(e,n);if(null===r)return null;var i=this.leftSE.point,o=this.rightSE.point,s=t.leftSE.point,a=t.rightSE.point,l=h(e,s)&&0===this.comparePoint(s),u=h(n,i)&&0===t.comparePoint(i),f=h(e,a)&&0===this.comparePoint(a),p=h(n,o)&&0===t.comparePoint(o);if(u&&l)return p&&!f?o:!p&&f?a:null;if(u)return f&&i.x===a.x&&i.y===a.y?null:i;if(l)return p&&o.x===s.x&&o.y===s.y?null:s;if(p&&f)return null;if(p)return o;if(f)return a;var d=function(t,e,n,r){if(0===e.x)return E(n,r,t.x);if(0===r.x)return E(t,e,n.x);if(0===e.y)return w(n,r,t.y);if(0===r.y)return w(t,e,n.y);var i=y(e,r);if(0==i)return null;var o={x:n.x-t.x,y:n.y-t.y},s=y(o,e)/i,a=y(o,r)/i;return{x:(t.x+a*e.x+(n.x+s*r.x))/2,y:(t.y+a*e.y+(n.y+s*r.y))/2}}(i,this.vector(),s,t.vector());return null===d?null:h(r,d)?m.round(d.x,d.y):null}},{key:"split",value:function(e){var n=[],r=void 0!==e.events,i=new k(e,!0),o=new k(e,!1),s=this.rightSE;this.replaceRightSE(o),n.push(o),n.push(i);var a=new t(i,s,this.rings.slice(),this.windings.slice());return k.comparePoints(a.leftSE.point,a.rightSE.point)>0&&a.swapEvents(),k.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),r&&(i.checkForConsuming(),o.checkForConsuming()),n}},{key:"swapEvents",value:function(){var t=this.rightSE;this.rightSE=this.leftSE,this.leftSE=t,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(var e=0,n=this.windings.length;e<n;e++)this.windings[e]*=-1}},{key:"consume",value:function(e){for(var n=this,r=e;n.consumedBy;)n=n.consumedBy;for(;r.consumedBy;)r=r.consumedBy;var i=t.compare(n,r);if(0!==i){if(i>0){var o=n;n=r,r=o}if(n.prev===r){var s=n;n=r,r=s}for(var a=0,l=r.rings.length;a<l;a++){var u=r.rings[a],h=r.windings[a],c=n.rings.indexOf(u);-1===c?(n.rings.push(u),n.windings.push(h)):n.windings[c]+=h}r.rings=null,r.windings=null,r.consumedBy=n,r.leftSE.consumedBy=n.leftSE,r.rightSE.consumedBy=n.rightSE}}},{key:"prevInResult",value:function(){return void 0!==this._prevInResult?this._prevInResult:(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null,this._prevInResult)}},{key:"beforeState",value:function(){if(void 0!==this._beforeState)return this._beforeState;if(this.prev){var t=this.prev.consumedBy||this.prev;this._beforeState=t.afterState()}else this._beforeState={rings:[],windings:[],multiPolys:[]};return this._beforeState}},{key:"afterState",value:function(){if(void 0!==this._afterState)return this._afterState;var t=this.beforeState();this._afterState={rings:t.rings.slice(0),windings:t.windings.slice(0),multiPolys:[]};for(var e=this._afterState.rings,n=this._afterState.windings,r=this._afterState.multiPolys,i=0,o=this.rings.length;i<o;i++){var s=this.rings[i],a=this.windings[i],l=e.indexOf(s);-1===l?(e.push(s),n.push(a)):n[l]+=a}for(var u=[],h=[],c=0,f=e.length;c<f;c++)if(0!==n[c]){var p=e[c],d=p.poly;if(-1===h.indexOf(d))if(p.isExterior)u.push(d);else{-1===h.indexOf(d)&&h.push(d);var g=u.indexOf(p.poly);-1!==g&&u.splice(g,1)}}for(var v=0,m=u.length;v<m;v++){var y=u[v].multiPoly;-1===r.indexOf(y)&&r.push(y)}return this._afterState}},{key:"isInResult",value:function(){if(this.consumedBy)return!1;if(void 0!==this._isInResult)return this._isInResult;var t=this.beforeState().multiPolys,e=this.afterState().multiPolys;switch(B.type){case"union":var n=0===t.length,r=0===e.length;this._isInResult=n!==r;break;case"intersection":var i,o;t.length<e.length?(i=t.length,o=e.length):(i=e.length,o=t.length),this._isInResult=o===B.numMultiPolys&&i<o;break;case"xor":var s=Math.abs(t.length-e.length);this._isInResult=s%2==1;break;case"difference":var a=function(t){return 1===t.length&&t[0].isSubject};this._isInResult=a(t)!==a(e);break;default:throw new Error("Unrecognized operation type found ".concat(B.type))}return this._isInResult}}],[{key:"fromRing",value:function(e,n,r){var i,o,s,a=k.comparePoints(e,n);if(a<0)i=e,o=n,s=1;else{if(!(a>0))throw new Error("Tried to create degenerate segment at [".concat(e.x,", ").concat(e.y,"]"));i=n,o=e,s=-1}return new t(new k(i,!0),new k(o,!1),[r],[s])}}]),t}(),P=function(){function t(n,r,i){if(e(this,t),!Array.isArray(n)||0===n.length)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=r,this.isExterior=i,this.segments=[],"number"!=typeof n[0][0]||"number"!=typeof n[0][1])throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var o=m.round(n[0][0],n[0][1]);this.bbox={ll:{x:o.x,y:o.y},ur:{x:o.x,y:o.y}};for(var s=o,a=1,l=n.length;a<l;a++){if("number"!=typeof n[a][0]||"number"!=typeof n[a][1])throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var u=m.round(n[a][0],n[a][1]);u.x===s.x&&u.y===s.y||(this.segments.push(M.fromRing(s,u,this)),u.x<this.bbox.ll.x&&(this.bbox.ll.x=u.x),u.y<this.bbox.ll.y&&(this.bbox.ll.y=u.y),u.x>this.bbox.ur.x&&(this.bbox.ur.x=u.x),u.y>this.bbox.ur.y&&(this.bbox.ur.y=u.y),s=u)}o.x===s.x&&o.y===s.y||this.segments.push(M.fromRing(s,o,this))}return r(t,[{key:"getSweepEvents",value:function(){for(var t=[],e=0,n=this.segments.length;e<n;e++){var r=this.segments[e];t.push(r.leftSE),t.push(r.rightSE)}return t}}]),t}(),L=function(){function t(n,r){if(e(this,t),!Array.isArray(n))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new P(n[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(var i=1,o=n.length;i<o;i++){var s=new P(n[i],this,!1);s.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=s.bbox.ll.x),s.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=s.bbox.ll.y),s.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=s.bbox.ur.x),s.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=s.bbox.ur.y),this.interiorRings.push(s)}this.multiPoly=r}return r(t,[{key:"getSweepEvents",value:function(){for(var t=this.exteriorRing.getSweepEvents(),e=0,n=this.interiorRings.length;e<n;e++)for(var r=this.interiorRings[e].getSweepEvents(),i=0,o=r.length;i<o;i++)t.push(r[i]);return t}}]),t}(),I=function(){function t(n,r){if(e(this,t),!Array.isArray(n))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{"number"==typeof n[0][0][0]&&(n=[n])}catch(t){}this.polys=[],this.bbox={ll:{x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY},ur:{x:Number.NEGATIVE_INFINITY,y:Number.NEGATIVE_INFINITY}};for(var i=0,o=n.length;i<o;i++){var s=new L(n[i],this);s.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=s.bbox.ll.x),s.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=s.bbox.ll.y),s.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=s.bbox.ur.x),s.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=s.bbox.ur.y),this.polys.push(s)}this.isSubject=r}return r(t,[{key:"getSweepEvents",value:function(){for(var t=[],e=0,n=this.polys.length;e<n;e++)for(var r=this.polys[e].getSweepEvents(),i=0,o=r.length;i<o;i++)t.push(r[i]);return t}}]),t}(),C=function(){function t(n){e(this,t),this.events=n;for(var r=0,i=n.length;r<i;r++)n[r].segment.ringOut=this;this.poly=null}return r(t,null,[{key:"factory",value:function(e){for(var n=[],r=0,i=e.length;r<i;r++){var o=e[r];if(o.isInResult()&&!o.ringOut){for(var s=null,a=o.leftSE,l=o.rightSE,u=[a],h=a.point,c=[];s=a,a=l,u.push(a),a.point!==h;)for(;;){var f=a.getAvailableLinkedEvents();if(0===f.length){var p=u[0].point,d=u[u.length-1].point;throw new Error("Unable to complete output ring starting at [".concat(p.x,",")+" ".concat(p.y,"]. Last matching segment found ends at")+" [".concat(d.x,", ").concat(d.y,"]."))}if(1===f.length){l=f[0].otherSE;break}for(var g=null,v=0,m=c.length;v<m;v++)if(c[v].point===a.point){g=v;break}if(null===g){c.push({index:u.length,point:a.point});var y=a.getLeftmostComparator(s);l=f.sort(y)[0].otherSE;break}var x=c.splice(g)[0],b=u.splice(x.index);b.unshift(b[0].otherSE),n.push(new t(b.reverse()))}n.push(new t(u))}}return n}}]),r(t,[{key:"getGeom",value:function(){for(var t=this.events[0].point,e=[t],n=1,r=this.events.length-1;n<r;n++){var i=this.events[n].point,o=this.events[n+1].point;0!==b(i,t,o)&&(e.push(i),t=i)}if(1===e.length)return null;var s=e[0],a=e[1];0===b(s,t,a)&&e.shift(),e.push(e[0]);for(var l=this.isExteriorRing()?1:-1,u=this.isExteriorRing()?0:e.length-1,h=this.isExteriorRing()?e.length:-1,c=[],f=u;f!=h;f+=l)c.push([e[f].x,e[f].y]);return c}},{key:"isExteriorRing",value:function(){if(void 0===this._isExteriorRing){var t=this.enclosingRing();this._isExteriorRing=!t||!t.isExteriorRing()}return this._isExteriorRing}},{key:"enclosingRing",value:function(){return void 0===this._enclosingRing&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}},{key:"_calcEnclosingRing",value:function(){for(var t=this.events[0],e=1,n=this.events.length;e<n;e++){var r=this.events[e];k.compare(t,r)>0&&(t=r)}for(var i=t.segment.prevInResult(),o=i?i.prevInResult():null;;){if(!i)return null;if(!o)return i.ringOut;if(o.ringOut!==i.ringOut)return o.ringOut.enclosingRing()!==i.ringOut?i.ringOut:i.ringOut.enclosingRing();o=(i=o.prevInResult())?i.prevInResult():null}}}]),t}(),F=function(){function t(n){e(this,t),this.exteriorRing=n,n.poly=this,this.interiorRings=[]}return r(t,[{key:"addInterior",value:function(t){this.interiorRings.push(t),t.poly=this}},{key:"getGeom",value:function(){var t=[this.exteriorRing.getGeom()];if(null===t[0])return null;for(var e=0,n=this.interiorRings.length;e<n;e++){var r=this.interiorRings[e].getGeom();null!==r&&t.push(r)}return t}}]),t}(),R=function(){function t(n){e(this,t),this.rings=n,this.polys=this._composePolys(n)}return r(t,[{key:"getGeom",value:function(){for(var t=[],e=0,n=this.polys.length;e<n;e++){var r=this.polys[e].getGeom();null!==r&&t.push(r)}return t}},{key:"_composePolys",value:function(t){for(var e=[],n=0,r=t.length;n<r;n++){var i=t[n];if(!i.poly)if(i.isExteriorRing())e.push(new F(i));else{var o=i.enclosingRing();o.poly||e.push(new F(o)),o.poly.addInterior(i)}}return e}}]),t}(),A=function(){function t(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:M.compare;e(this,t),this.queue=n,this.tree=new u(r),this.segments=[]}return r(t,[{key:"process",value:function(t){var e=t.segment,n=[];if(t.consumedBy)return t.isLeft?this.queue.remove(t.otherSE):this.tree.remove(e),n;var r=t.isLeft?this.tree.insert(e):this.tree.find(e);if(!r)throw new Error("Unable to find segment #".concat(e.id," ")+"[".concat(e.leftSE.point.x,", ").concat(e.leftSE.point.y,"] -> ")+"[".concat(e.rightSE.point.x,", ").concat(e.rightSE.point.y,"] ")+"in SweepLine tree. Please submit a bug report.");for(var i=r,o=r,s=void 0,a=void 0;void 0===s;)null===(i=this.tree.prev(i))?s=null:void 0===i.key.consumedBy&&(s=i.key);for(;void 0===a;)null===(o=this.tree.next(o))?a=null:void 0===o.key.consumedBy&&(a=o.key);if(t.isLeft){var l=null;if(s){var u=s.getIntersection(e);if(null!==u&&(e.isAnEndpoint(u)||(l=u),!s.isAnEndpoint(u)))for(var h=this._splitSafely(s,u),c=0,f=h.length;c<f;c++)n.push(h[c])}var p=null;if(a){var d=a.getIntersection(e);if(null!==d&&(e.isAnEndpoint(d)||(p=d),!a.isAnEndpoint(d)))for(var g=this._splitSafely(a,d),v=0,m=g.length;v<m;v++)n.push(g[v])}if(null!==l||null!==p){var y=null;if(null===l)y=p;else if(null===p)y=l;else{y=k.comparePoints(l,p)<=0?l:p}this.queue.remove(e.rightSE),n.push(e.rightSE);for(var x=e.split(y),b=0,_=x.length;b<_;b++)n.push(x[b])}n.length>0?(this.tree.remove(e),n.push(t)):(this.segments.push(e),e.prev=s)}else{if(s&&a){var w=s.getIntersection(a);if(null!==w){if(!s.isAnEndpoint(w))for(var E=this._splitSafely(s,w),S=0,M=E.length;S<M;S++)n.push(E[S]);if(!a.isAnEndpoint(w))for(var P=this._splitSafely(a,w),L=0,I=P.length;L<I;L++)n.push(P[L])}}this.tree.remove(e)}return n}},{key:"_splitSafely",value:function(t,e){this.tree.remove(t);var n=t.rightSE;this.queue.remove(n);var r=t.split(e);return r.push(n),void 0===t.consumedBy&&this.tree.insert(t),r}}]),t}(),T=void 0!==t&&t.env.POLYGON_CLIPPING_MAX_QUEUE_SIZE||1e6,O=void 0!==t&&t.env.POLYGON_CLIPPING_MAX_SWEEPLINE_SEGMENTS||1e6,B=new(function(){function t(){e(this,t)}return r(t,[{key:"run",value:function(t,e,n){B.type=t,m.reset();for(var r=[new I(e,!0)],i=0,o=n.length;i<o;i++)r.push(new I(n[i],!1));if(B.numMultiPolys=r.length,"difference"===B.type)for(var s=r[0],a=1;a<r.length;)null!==c(r[a].bbox,s.bbox)?a++:r.splice(a,1);if("intersection"===B.type)for(var l=0,h=r.length;l<h;l++)for(var f=r[l],p=l+1,d=r.length;p<d;p++)if(null===c(f.bbox,r[p].bbox))return[];for(var g=new u(k.compare),v=0,y=r.length;v<y;v++)for(var x=r[v].getSweepEvents(),b=0,_=x.length;b<_;b++)if(g.insert(x[b]),g.size>T)throw new Error("Infinite loop when putting segment endpoints in a priority queue (queue size too big). Please file a bug report.");for(var w=new A(g),E=g.size,S=g.pop();S;){var M=S.key;if(g.size===E){var P=M.segment;throw new Error("Unable to pop() ".concat(M.isLeft?"left":"right"," SweepEvent ")+"[".concat(M.point.x,", ").concat(M.point.y,"] from segment #").concat(P.id," ")+"[".concat(P.leftSE.point.x,", ").concat(P.leftSE.point.y,"] -> ")+"[".concat(P.rightSE.point.x,", ").concat(P.rightSE.point.y,"] from queue. ")+"Please file a bug report.")}if(g.size>T)throw new Error("Infinite loop when passing sweep line over endpoints (queue size too big). Please file a bug report.");if(w.segments.length>O)throw new Error("Infinite loop when passing sweep line over endpoints (too many sweep line segments). Please file a bug report.");for(var L=w.process(M),F=0,j=L.length;F<j;F++){var N=L[F];void 0===N.consumedBy&&g.insert(N)}E=g.size,S=g.pop()}m.reset();var Y=C.factory(w.segments);return new R(Y).getGeom()}}]),t}());return{union:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return B.run("union",t,n)},intersection:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return B.run("intersection",t,n)},xor:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return B.run("xor",t,n)},difference:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return B.run("difference",t,n)}}},"object"==typeof n&&void 0!==e?e.exports=i():(r="undefined"!=typeof globalThis?globalThis:r||self).polygonClipping=i()}).call(this)}).call(this,t("_process"))},{_process:21}],21:[function(t,e,n){var r,i,o=e.exports={};function s(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function l(t){if(r===setTimeout)return setTimeout(t,0);if((r===s||!r)&&setTimeout)return r=setTimeout,setTimeout(t,0);try{return r(t,0)}catch(e){try{return r.call(null,t,0)}catch(e){return r.call(this,t,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:s}catch(t){r=s}try{i="function"==typeof clearTimeout?clearTimeout:a}catch(t){i=a}}();var u,h=[],c=!1,f=-1;function p(){c&&u&&(c=!1,u.length?h=u.concat(h):f=-1,h.length&&d())}function d(){if(!c){var t=l(p);c=!0;for(var e=h.length;e;){for(u=h,h=[];++f<e;)u&&u[f].run();f=-1,e=h.length}u=null,c=!1,function(t){if(i===clearTimeout)return clearTimeout(t);if((i===a||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(t);try{i(t)}catch(e){try{return i.call(null,t)}catch(e){return i.call(this,t)}}}(t)}}function g(t,e){this.fun=t,this.array=e}function v(){}o.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];h.push(new g(t,e)),1!==h.length||c||l(d)},g.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=v,o.addListener=v,o.once=v,o.off=v,o.removeListener=v,o.removeAllListeners=v,o.emit=v,o.prependListener=v,o.prependOnceListener=v,o.listeners=function(t){return[]},o.binding=function(t){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(t){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},{}],22:[function(t,e,n){var r,i;r=this,i=function(){"use strict";function t(t,r,i,o,s){!function t(n,r,i,o,s){for(;o>i;){if(o-i>600){var a=o-i+1,l=r-i+1,u=Math.log(a),h=.5*Math.exp(2*u/3),c=.5*Math.sqrt(u*h*(a-h)/a)*(l-a/2<0?-1:1);t(n,r,Math.max(i,Math.floor(r-l*h/a+c)),Math.min(o,Math.floor(r+(a-l)*h/a+c)),s)}var f=n[r],p=i,d=o;for(e(n,i,r),s(n[o],f)>0&&e(n,i,o);p<d;){for(e(n,p,d),p++,d--;s(n[p],f)<0;)p++;for(;s(n[d],f)>0;)d--}0===s(n[i],f)?e(n,i,d):e(n,++d,o),d<=r&&(i=d+1),r<=d&&(o=d-1)}}(t,r,i||0,o||t.length-1,s||n)}function e(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function n(t,e){return t<e?-1:t>e?1:0}var r=function(t){void 0===t&&(t=9),this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function i(t,e,n){if(!n)return e.indexOf(t);for(var r=0;r<e.length;r++)if(n(t,e[r]))return r;return-1}function o(t,e){s(t,0,t.children.length,e,t)}function s(t,e,n,r,i){i||(i=d(null)),i.minX=1/0,i.minY=1/0,i.maxX=-1/0,i.maxY=-1/0;for(var o=e;o<n;o++){var s=t.children[o];a(i,t.leaf?r(s):s)}return i}function a(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function l(t,e){return t.minX-e.minX}function u(t,e){return t.minY-e.minY}function h(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function c(t){return t.maxX-t.minX+(t.maxY-t.minY)}function f(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function p(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function d(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function g(e,n,r,i,o){for(var s=[n,r];s.length;)if(!((r=s.pop())-(n=s.pop())<=i)){var a=n+Math.ceil((r-n)/i/2)*i;t(e,a,n,r,o),s.push(n,a,a,r)}}return r.prototype.all=function(){return this._all(this.data,[])},r.prototype.search=function(t){var e=this.data,n=[];if(!p(t,e))return n;for(var r=this.toBBox,i=[];e;){for(var o=0;o<e.children.length;o++){var s=e.children[o],a=e.leaf?r(s):s;p(t,a)&&(e.leaf?n.push(s):f(t,a)?this._all(s,n):i.push(s))}e=i.pop()}return n},r.prototype.collides=function(t){var e=this.data;if(!p(t,e))return!1;for(var n=[];e;){for(var r=0;r<e.children.length;r++){var i=e.children[r],o=e.leaf?this.toBBox(i):i;if(p(t,o)){if(e.leaf||f(t,o))return!0;n.push(i)}}e=n.pop()}return!1},r.prototype.load=function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0;e<t.length;e++)this.insert(t[e]);return this}var n=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){var r=this.data;this.data=n,n=r}this._insert(n,this.data.height-n.height-1,!0)}else this.data=n;return this},r.prototype.insert=function(t){return t&&this._insert(t,this.data.height-1),this},r.prototype.clear=function(){return this.data=d([]),this},r.prototype.remove=function(t,e){if(!t)return this;for(var n,r,o,s=this.data,a=this.toBBox(t),l=[],u=[];s||l.length;){if(s||(s=l.pop(),r=l[l.length-1],n=u.pop(),o=!0),s.leaf){var h=i(t,s.children,e);if(-1!==h)return s.children.splice(h,1),l.push(s),this._condense(l),this}o||s.leaf||!f(s,a)?r?(n++,s=r.children[n],o=!1):s=null:(l.push(s),u.push(n),n=0,r=s,s=s.children[0])}return this},r.prototype.toBBox=function(t){return t},r.prototype.compareMinX=function(t,e){return t.minX-e.minX},r.prototype.compareMinY=function(t,e){return t.minY-e.minY},r.prototype.toJSON=function(){return this.data},r.prototype.fromJSON=function(t){return this.data=t,this},r.prototype._all=function(t,e){for(var n=[];t;)t.leaf?e.push.apply(e,t.children):n.push.apply(n,t.children),t=n.pop();return e},r.prototype._build=function(t,e,n,r){var i,s=n-e+1,a=this._maxEntries;if(s<=a)return o(i=d(t.slice(e,n+1)),this.toBBox),i;r||(r=Math.ceil(Math.log(s)/Math.log(a)),a=Math.ceil(s/Math.pow(a,r-1))),(i=d([])).leaf=!1,i.height=r;var l=Math.ceil(s/a),u=l*Math.ceil(Math.sqrt(a));g(t,e,n,u,this.compareMinX);for(var h=e;h<=n;h+=u){var c=Math.min(h+u-1,n);g(t,h,c,l,this.compareMinY);for(var f=h;f<=c;f+=l){var p=Math.min(f+l-1,c);i.children.push(this._build(t,f,p,r-1))}}return o(i,this.toBBox),i},r.prototype._chooseSubtree=function(t,e,n,r){for(;r.push(e),!e.leaf&&r.length-1!==n;){for(var i=1/0,o=1/0,s=void 0,a=0;a<e.children.length;a++){var l=e.children[a],u=h(l),c=(f=t,p=l,(Math.max(p.maxX,f.maxX)-Math.min(p.minX,f.minX))*(Math.max(p.maxY,f.maxY)-Math.min(p.minY,f.minY))-u);c<o?(o=c,i=u<i?u:i,s=l):c===o&&u<i&&(i=u,s=l)}e=s||e.children[0]}var f,p;return e},r.prototype._insert=function(t,e,n){var r=n?t:this.toBBox(t),i=[],o=this._chooseSubtree(r,this.data,e,i);for(o.children.push(t),a(o,r);e>=0&&i[e].children.length>this._maxEntries;)this._split(i,e),e--;this._adjustParentBBoxes(r,i,e)},r.prototype._split=function(t,e){var n=t[e],r=n.children.length,i=this._minEntries;this._chooseSplitAxis(n,i,r);var s=this._chooseSplitIndex(n,i,r),a=d(n.children.splice(s,n.children.length-s));a.height=n.height,a.leaf=n.leaf,o(n,this.toBBox),o(a,this.toBBox),e?t[e-1].children.push(a):this._splitRoot(n,a)},r.prototype._splitRoot=function(t,e){this.data=d([t,e]),this.data.height=t.height+1,this.data.leaf=!1,o(this.data,this.toBBox)},r.prototype._chooseSplitIndex=function(t,e,n){for(var r,i,o,a,l,u,c,f=1/0,p=1/0,d=e;d<=n-e;d++){var g=s(t,0,d,this.toBBox),v=s(t,d,n,this.toBBox),m=(i=g,o=v,a=void 0,l=void 0,u=void 0,c=void 0,a=Math.max(i.minX,o.minX),l=Math.max(i.minY,o.minY),u=Math.min(i.maxX,o.maxX),c=Math.min(i.maxY,o.maxY),Math.max(0,u-a)*Math.max(0,c-l)),y=h(g)+h(v);m<f?(f=m,r=d,p=y<p?y:p):m===f&&y<p&&(p=y,r=d)}return r||n-e},r.prototype._chooseSplitAxis=function(t,e,n){var r=t.leaf?this.compareMinX:l,i=t.leaf?this.compareMinY:u;this._allDistMargin(t,e,n,r)<this._allDistMargin(t,e,n,i)&&t.children.sort(r)},r.prototype._allDistMargin=function(t,e,n,r){t.children.sort(r);for(var i=this.toBBox,o=s(t,0,e,i),l=s(t,n-e,n,i),u=c(o)+c(l),h=e;h<n-e;h++){var f=t.children[h];a(o,t.leaf?i(f):f),u+=c(o)}for(var p=n-e-1;p>=e;p--){var d=t.children[p];a(l,t.leaf?i(d):d),u+=c(l)}return u},r.prototype._adjustParentBBoxes=function(t,e,n){for(var r=n;r>=0;r--)a(e[r],t)},r.prototype._condense=function(t){for(var e=t.length-1,n=void 0;e>=0;e--)0===t[e].children.length?e>0?(n=t[e-1].children).splice(n.indexOf(t[e]),1):this.clear():o(t[e],this.toBBox)},r},"object"==typeof n&&void 0!==e?e.exports=i():(r=r||self).RBush=i()},{}],23:[function(t,e,n){var r;r=this,function(t){"use strict";const e=134217729;function n(t,e,n,r,i){let o,s,a,l,u=e[0],h=r[0],c=0,f=0;h>u==h>-u?(o=u,u=e[++c]):(o=h,h=r[++f]);let p=0;if(c<t&&f<n)for(h>u==h>-u?(a=o-((s=u+o)-u),u=e[++c]):(a=o-((s=h+o)-h),h=r[++f]),o=s,0!==a&&(i[p++]=a);c<t&&f<n;)h>u==h>-u?(a=o-((s=o+u)-(l=s-o))+(u-l),u=e[++c]):(a=o-((s=o+h)-(l=s-o))+(h-l),h=r[++f]),o=s,0!==a&&(i[p++]=a);for(;c<t;)a=o-((s=o+u)-(l=s-o))+(u-l),u=e[++c],o=s,0!==a&&(i[p++]=a);for(;f<n;)a=o-((s=o+h)-(l=s-o))+(h-l),h=r[++f],o=s,0!==a&&(i[p++]=a);return 0===o&&0!==p||(i[p++]=o),p}function r(t){return new Float64Array(t)}const i=r(4),o=r(8),s=r(12),a=r(16),l=r(4);t.orient2d=function(t,r,u,h,c,f){const p=(r-f)*(u-c),d=(t-c)*(h-f),g=p-d;if(0===p||0===d||p>0!=d>0)return g;const v=Math.abs(p+d);return Math.abs(g)>=3.3306690738754716e-16*v?g:-function(t,r,u,h,c,f,p){let d,g,v,m,y,x,b,_,w,E,k,S,M,P,L,I,C,F;const R=t-c,A=u-c,T=r-f,O=h-f;y=(L=(_=R-(b=(x=e*R)-(x-R)))*(E=O-(w=(x=e*O)-(x-O)))-((P=R*O)-b*w-_*w-b*E))-(k=L-(C=(_=T-(b=(x=e*T)-(x-T)))*(E=A-(w=(x=e*A)-(x-A)))-((I=T*A)-b*w-_*w-b*E))),i[0]=L-(k+y)+(y-C),y=(M=P-((S=P+k)-(y=S-P))+(k-y))-(k=M-I),i[1]=M-(k+y)+(y-I),y=(F=S+k)-S,i[2]=S-(F-y)+(k-y),i[3]=F;let B=function(t,e){let n=e[0];for(let t=1;t<4;t++)n+=e[t];return n}(0,i),j=2.2204460492503146e-16*p;if(B>=j||-B>=j)return B;if(d=t-(R+(y=t-R))+(y-c),v=u-(A+(y=u-A))+(y-c),g=r-(T+(y=r-T))+(y-f),m=h-(O+(y=h-O))+(y-f),0===d&&0===g&&0===v&&0===m)return B;if(j=1.1093356479670487e-31*p+3.3306690738754706e-16*Math.abs(B),(B+=R*m+O*d-(T*v+A*g))>=j||-B>=j)return B;y=(L=(_=d-(b=(x=e*d)-(x-d)))*(E=O-(w=(x=e*O)-(x-O)))-((P=d*O)-b*w-_*w-b*E))-(k=L-(C=(_=g-(b=(x=e*g)-(x-g)))*(E=A-(w=(x=e*A)-(x-A)))-((I=g*A)-b*w-_*w-b*E))),l[0]=L-(k+y)+(y-C),y=(M=P-((S=P+k)-(y=S-P))+(k-y))-(k=M-I),l[1]=M-(k+y)+(y-I),y=(F=S+k)-S,l[2]=S-(F-y)+(k-y),l[3]=F;const N=n(4,i,4,l,o);y=(L=(_=R-(b=(x=e*R)-(x-R)))*(E=m-(w=(x=e*m)-(x-m)))-((P=R*m)-b*w-_*w-b*E))-(k=L-(C=(_=T-(b=(x=e*T)-(x-T)))*(E=v-(w=(x=e*v)-(x-v)))-((I=T*v)-b*w-_*w-b*E))),l[0]=L-(k+y)+(y-C),y=(M=P-((S=P+k)-(y=S-P))+(k-y))-(k=M-I),l[1]=M-(k+y)+(y-I),y=(F=S+k)-S,l[2]=S-(F-y)+(k-y),l[3]=F;const Y=n(N,o,4,l,s);y=(L=(_=d-(b=(x=e*d)-(x-d)))*(E=m-(w=(x=e*m)-(x-m)))-((P=d*m)-b*w-_*w-b*E))-(k=L-(C=(_=g-(b=(x=e*g)-(x-g)))*(E=v-(w=(x=e*v)-(x-v)))-((I=g*v)-b*w-_*w-b*E))),l[0]=L-(k+y)+(y-C),y=(M=P-((S=P+k)-(y=S-P))+(k-y))-(k=M-I),l[1]=M-(k+y)+(y-I),y=(F=S+k)-S,l[2]=S-(F-y)+(k-y),l[3]=F;const X=n(Y,s,4,l,a);return a[X-1]}(t,r,u,h,c,f,v)},t.orient2dfast=function(t,e,n,r,i,o){return(e-o)*(n-i)-(t-i)*(r-o)},Object.defineProperty(t,"__esModule",{value:!0})}("object"==typeof n&&void 0!==e?n:(r=r||self).predicates={})},{}],24:[function(t,e,n){"use strict";var r=t("./src/suggestions");e.exports=r,"undefined"!=typeof window&&(window.Suggestions=r)},{"./src/suggestions":26}],25:[function(t,e,n){"use strict";var r=function(t){return this.component=t,this.items=[],this.active=0,this.wrapper=document.createElement("div"),this.wrapper.className="suggestions-wrapper",this.element=document.createElement("ul"),this.element.className="suggestions",this.wrapper.appendChild(this.element),this.selectingListItem=!1,t.el.parentNode.insertBefore(this.wrapper,t.el.nextSibling),this};r.prototype.show=function(){this.element.style.display="block"},r.prototype.hide=function(){this.element.style.display="none"},r.prototype.add=function(t){this.items.push(t)},r.prototype.clear=function(){this.items=[],this.active=0},r.prototype.isEmpty=function(){return!this.items.length},r.prototype.isVisible=function(){return"block"===this.element.style.display},r.prototype.draw=function(){if(this.element.innerHTML="",0!==this.items.length){for(var t=0;t<this.items.length;t++)this.drawItem(this.items[t],this.active===t);this.show()}else this.hide()},r.prototype.drawItem=function(t,e){var n=document.createElement("li"),r=document.createElement("a");e&&(n.className+=" active"),r.innerHTML=t.string,n.appendChild(r),this.element.appendChild(n),n.addEventListener("mousedown",function(){this.selectingListItem=!0}.bind(this)),n.addEventListener("mouseup",function(){this.handleMouseUp.call(this,t)}.bind(this))},r.prototype.handleMouseUp=function(t){this.selectingListItem=!1,this.component.value(t.original),this.clear(),this.draw()},r.prototype.move=function(t){this.active=t,this.draw()},r.prototype.previous=function(){this.move(0===this.active?this.items.length-1:this.active-1)},r.prototype.next=function(){this.move(this.active===this.items.length-1?0:this.active+1)},r.prototype.drawError=function(t){var e=document.createElement("li");e.innerHTML=t,this.element.appendChild(e),this.show()},e.exports=r},{}],26:[function(t,e,n){"use strict";var r=t("xtend"),i=t("fuzzy"),o=t("./list"),s=function(t,e,n){return n=n||{},this.options=r({minLength:2,limit:5,filter:!0,hideOnBlur:!0},n),this.el=t,this.data=e||[],this.list=new o(this),this.query="",this.selected=null,this.list.draw(),this.el.addEventListener("keyup",function(t){this.handleKeyUp(t.keyCode)}.bind(this),!1),this.el.addEventListener("keydown",function(t){this.handleKeyDown(t)}.bind(this)),this.el.addEventListener("focus",function(){this.handleFocus()}.bind(this)),this.el.addEventListener("blur",function(){this.handleBlur()}.bind(this)),this.el.addEventListener("paste",function(t){this.handlePaste(t)}.bind(this)),this.render=this.options.render?this.options.render.bind(this):this.render.bind(this),this.getItemValue=this.options.getItemValue?this.options.getItemValue.bind(this):this.getItemValue.bind(this),this};s.prototype.handleKeyUp=function(t){40!==t&&38!==t&&27!==t&&13!==t&&9!==t&&this.handleInputChange(this.el.value)},s.prototype.handleKeyDown=function(t){switch(t.keyCode){case 13:case 9:this.list.isEmpty()||(this.list.isVisible()&&t.preventDefault(),this.value(this.list.items[this.list.active].original),this.list.hide());break;case 27:this.list.isEmpty()||this.list.hide();break;case 38:this.list.previous();break;case 40:this.list.next()}},s.prototype.handleBlur=function(){!this.list.selectingListItem&&this.options.hideOnBlur&&this.list.hide()},s.prototype.handlePaste=function(t){if(t.clipboardData)this.handleInputChange(t.clipboardData.getData("Text"));else{var e=this;setTimeout(function(){e.handleInputChange(t.target.value)},100)}},s.prototype.handleInputChange=function(t){this.query=this.normalize(t),this.list.clear(),this.query.length<this.options.minLength?this.list.draw():this.getCandidates(function(t){for(var e=0;e<t.length&&(this.list.add(t[e]),e!==this.options.limit-1);e++);this.list.draw()}.bind(this))},s.prototype.handleFocus=function(){this.list.isEmpty()||this.list.show(),this.list.selectingListItem=!1},s.prototype.update=function(t){this.data=t,this.handleKeyUp()},s.prototype.clear=function(){this.data=[],this.list.clear()},s.prototype.normalize=function(t){return t=t.toLowerCase()},s.prototype.match=function(t,e){return t.indexOf(e)>-1},s.prototype.value=function(t){if(this.selected=t,this.el.value=this.getItemValue(t),document.createEvent){var e=document.createEvent("HTMLEvents");e.initEvent("change",!0,!1),this.el.dispatchEvent(e)}else this.el.fireEvent("onchange")},s.prototype.getCandidates=function(t){var e={pre:"<strong>",post:"</strong>",extract:function(t){return this.getItemValue(t)}.bind(this)};t(this.options.filter?i.filter(this.query,this.data,e).map(function(t){return{original:t.original,string:this.render(t.original,t.string)}}.bind(this)):this.data.map(function(t){return{original:t,string:this.render(t)}}.bind(this)))},s.prototype.getItemValue=function(t){return t},s.prototype.render=function(t,e){if(e)return e;for(var n=t.original?this.getItemValue(t.original):this.getItemValue(t),r=this.normalize(n),i=r.lastIndexOf(this.query);i>-1;){var o=i+this.query.length;n=n.slice(0,i)+"<strong>"+n.slice(i,o)+"</strong>"+n.slice(o),i=r.slice(0,i).lastIndexOf(this.query)}return n},s.prototype.renderError=function(t){this.list.drawError(t)},e.exports=s},{"./list":25,fuzzy:14,xtend:28}],27:[function(t,e,n){var r,i;r=this,i=function(){"use strict";var t=function(t,n){if(void 0===t&&(t=[]),void 0===n&&(n=e),this.data=t,this.length=this.data.length,this.compare=n,this.length>0)for(var r=(this.length>>1)-1;r>=0;r--)this._down(r)};function e(t,e){return t<e?-1:t>e?1:0}return t.prototype.push=function(t){this.data.push(t),this.length++,this._up(this.length-1)},t.prototype.pop=function(){if(0!==this.length){var t=this.data[0],e=this.data.pop();return this.length--,this.length>0&&(this.data[0]=e,this._down(0)),t}},t.prototype.peek=function(){return this.data[0]},t.prototype._up=function(t){for(var e=this.data,n=this.compare,r=e[t];t>0;){var i=t-1>>1,o=e[i];if(n(r,o)>=0)break;e[t]=o,t=i}e[t]=r},t.prototype._down=function(t){for(var e=this.data,n=this.compare,r=this.length>>1,i=e[t];t<r;){var o=1+(t<<1),s=e[o],a=o+1;if(a<this.length&&n(e[a],s)<0&&(o=a,s=e[a]),n(s,i)>=0)break;e[t]=s,t=o}e[t]=i},t},"object"==typeof n&&void 0!==e?e.exports=i():(r=r||self).TinyQueue=i()},{}],28:[function(t,e,n){e.exports=function(){for(var t={},e=0;e<arguments.length;e++){var n=arguments[e];for(var i in n)r.call(n,i)&&(t[i]=n[i])}return t};var r=Object.prototype.hasOwnProperty},{}]},{},[1])(1)});
